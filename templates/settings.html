{% extends 'base.html' %}

{% from '_macro_settings.html' import render_controller_config %}

{% block cssextend %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap-colorpicker.min.css') }}" type="text/css" />
<link rel="stylesheet" href="{{ url_for('static', filename='css/settings.css') }}" type="text/css" />
{% endblock %}

{% block title %}Settings{% endblock %}

{% block notify %}
    <!-- Settings Success -->
    {% if (alert['type'] == "error") %}                    
    <div class="notification-window">
        <div class="alert alert-danger alert-dismissible">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <b><i class="fas fa-exclamation-triangle"></i>&nbsp; ERROR:</b> <i>{{ alert['text'] }}</i>
        </div>
    </div>
    {% endif %}
    {% if (alert['type'] == "warning") %}                    
    <div class="notification-window">
        <div class="alert alert-warning alert-dismissible">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <b><i class="fas fa-exclamation-circle"></i>&nbsp; WARNING:</b> <i>{{ alert['text'] }}</i>
        </div>
    </div>
    {% endif %}
    {% if (alert['type'] == "updated") %}                          
    <div class="notification-window">
        <div class="alert alert-success alert-dismissible">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <b><i class="fas fa-check-circle"></i>&nbsp; SUCCESS:</b> <i>{{ alert['text'] }}</i>
        </div>
    </div>
    {% endif %}
{% endblock %}

{% block precontainer %}

{% endblock %}

{% block content %}    
    <div class="row">
        <!-- Spacer for Left Nav on large screens -->
        <div class="col-lg-2 d-none d-lg-block"></div>
        <!-- Spacer for Sub Nav on everything but large screens -->
        <div class="col-12 mt-5 d-lg-none d-block"></div>
        <!-- Nav Content-->
        <aside class="col-12 col-lg-2 navbar-dark bg-dark px-0 position-fixed vh-lg-100 border-bottom" style="z-index:1000;">
            <nav class="navbar navbar-expand-lg px-0">   
                <button class="ml-auto btn btn-warning mr-2 d-lg-none d-flex justify-content-center align-items-center" data-toggle="collapse" data-target="#settingsNav" aria-controls="settingsNav" aria-expanded="false" aria-label="Toggle navigation">
                    <b>Settings</b><span class="fa fa-chevron-down ml-2"></span>
                </button>
                <div class="collapse navbar-collapse overflow-auto mt-2 px-0 ml-auto col-12 col-lg-auto" style="z-index:1001;" id="settingsNav"> 
                    <ul class="nav nav-pills flex-column mx-auto px-0">
                        <li class="nav-item mt-1 px-1">
                            <a class="nav-link subnav-link active d-flex align-items-start" id="v-pills-misc-tab" data-toggle="pill" href="#v-pills-misc" role="tab" aria-controls="v-pills-misc" aria-selected="true">Misc Settings</a>
                        </li>
                        <li class="nav-item mt-1 px-1">
                            <a class="nav-link subnav-link d-flex align-items-start" id="v-pills-history-tab" data-toggle="pill" href="#v-pills-history" role="tab" aria-controls="v-pills-history" aria-selected="false">History</a>
                        </li>
                        <li class="nav-item mt-1 px-1">
                            <a class="nav-link subnav-link d-flex align-items-start" id="v-pills-notifications-tab" data-toggle="pill" href="#v-pills-notifications" role="tab" aria-controls="v-pills-notifications" aria-selected="false">Notifications</a>
                        </li>
                        <li class="nav-item mt-1 px-1">
                            <a class="nav-link subnav-link d-flex align-items-start" id="v-pills-pellets-tab" data-toggle="pill" href="#v-pills-pellets" role="tab" aria-controls="v-pills-pellets" aria-selected="false">Pellets</a>
                        </li>
                        <li class="nav-item mt-1 px-1">
                            <a class="nav-link subnav-link d-flex align-items-start" id="v-pills-probes-tab" data-toggle="pill" href="#v-pills-probes" role="tab" aria-controls="v-pills-probes" aria-selected="false">Probes</a>
                        </li>
                            {% if settings['globals']['dc_fan'] %}
                        <li class="nav-item mt-1 px-1">
                            <a class="nav-link subnav-link d-flex align-items-start" id="v-pills-pwm-tab" data-toggle="pill" href="#v-pills-pwm" role="tab" aria-controls="v-pills-pwm" aria-selected="false">PWM Settings</a>
                        </li>
                        {% endif %}
                        <li class="nav-item mt-1 px-1">
                            <a class="nav-link subnav-link d-flex align-items-center" id="v-pills-safety-tab" data-toggle="pill" href="#v-pills-safety" role="tab" aria-controls="v-pills-safety" aria-selected="false">
                                Safety
                                {% if settings['safety']['startup_check'] %}
                                    <i class="fas fa-check-circle text-success ml-auto"></i>
                                {% else %}
                                    <i class="fas fa-times-circle text-danger ml-auto"></i>
                                {% endif %}
                            </a>
                        </li>
                        <li class="nav-item mt-1 px-1">
                            <a class="nav-link subnav-link d-flex align-items-start" id="v-pills-startup-tab" data-toggle="pill" href="#v-pills-startup" role="tab" aria-controls="v-pills-startup" aria-selected="false">Startup & Shutdown</a>
                        </li>
                        <li class="nav-item mt-1 px-1">
                            <a class="nav-link subnav-link d-flex align-items-start" id="v-pills-work-mode-tab" data-toggle="pill" href="#v-pills-work-mode" role="tab" aria-controls="v-pills-work-mode" aria-selected="false">Work Mode</a>
                        </li>
                    </ul> 
                </div>
            </nav>
        </aside> 

<!-- Pills content -->
        <div class="col-12 col-lg-7 mx-auto mt-2" style="z-index: 0;">
            <input type="hidden" id="units" name="units" value="{{ settings['globals']['units'] }}">
            <div class="overflow-auto">
                <div class="tab-content" id="v-pills-tabContent">
                    <!-- ============================ Misc Settings ========================== -->
                    <div class="tab-pane fade show active" id="v-pills-misc" role="tabpanel" aria-labelledby="v-pills-misc-tab">
                        <div class="card shadow">
                            <form name="Misc" action="/settings/misc#v-pills-misc" method="POST">
                                <div class="card-header bg-primary text-white">
                                    <h5>
                                        <i class="fas fa-file-signature mr-2"></i>Misc Settings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="list-group mb-1 shadow">
                                        <!-- Grill Name -->
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong><i class="fas fa-user-ninja mr-2"></i>Grill Name</strong>
                                                </div>
                                                <div class="col-7 col-lg-6 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                    <input id="grill_name" type="text" inputmode="text" class="form-control" placeholder="{{ settings['globals']['grill_name'] }}" value="{{ settings['globals']['grill_name'] }}" name="grill_name">
                                                </div>
                                               
                                            </div>
                                        </div>

                                        <!-- Dashboard -->
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong><i class="fas fa-tools mr-2"></i>Select Dashboard</strong>
                                                </div>
                                                <div class="d-flex justify-content-end">
                                                    <select class="form-control w-auto" id="dashboardSelect" name="dashboardSelect">
                                                        {% for dashboard, dashinfo in settings['dashboard']['dashboards'].items() %}
                                                        <option value="{{ dashboard }}"{% if dashinfo['name'] == settings['dashboard']['current'] %} selected{% endif %}>{{ dashinfo['name'] }}</option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Units -->
                                        <div class="list-group-item">
                                            <div class="d-flex justify-content-between align-items-center mb-2">
                                                <div>
                                                    <strong><i class="fas fa-temperature-low mr-2"></i>Select Units</strong>
                                                </div>
                                                <div>
                                                    <select class="form-control w-auto" id="selectUnits" name="units">
                                                        <option value="F" {% if settings['globals']['units'] == 'F' %}selected{% endif %}>Fahrenheit (F)</option>
                                                        <option value="C" {% if settings['globals']['units'] == 'C' %}selected{% endif %}>Celsius (C)</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <p class="text-muted mt-1 mb-0 p-2">
                                                        <span class="badge badge-note mr-2">NOTE</span> 
                                                        Changing the scale/units will restart the grill controller (stopping any currently running modes) and automatically erase history.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Dark Mode -->
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong><i class="fas fa-palette mr-2"></i>Dark Mode</strong>
                                                </div>
                                                <div class="custom-control custom-switch d-flex justify-content-end">
                                                    <input type="checkbox" class="custom-control-input" id="darkmode" name="darkmode" {% if settings['globals']['page_theme'] == 'dark' %}checked{% endif %}>
                                                    <label class="custom-control-label" for="darkmode"></label>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Control Panel -->
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between mb-2">
                                                <div>
                                                    <strong><i class="fas fa-cogs mr-2"></i>Bottom Control Panel</strong>
                                                </div>
                                                <div class="custom-control custom-switch d-flex justify-content-end">
                                                    <input type="checkbox" class="custom-control-input" id="global_control_panel" name="global_control_panel" {% if settings['globals']['global_control_panel'] %}checked{% endif %}>
                                                    <label class="custom-control-label" for="global_control_panel"></label>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <p class="text-muted mb-0 mt-1">Show the bottom control panel on most pages.</p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Boot to Monitor Mode -->
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between mb-2">
                                                <div>
                                                    <strong><i class="fas fa-desktop mr-2"></i>Boot to Monitor Mode</strong>
                                                </div>
                                                <div class="custom-control custom-switch d-flex justify-content-end">
                                                    <input type="checkbox" class="custom-control-input" id="boot_to_monitor" name="boot_to_monitor" {% if settings['globals']['boot_to_monitor'] %}checked{% endif %}>
                                                    <label class="custom-control-label" for="boot_to_monitor"></label>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <p class="text-muted mb-0 mt-1">Boots hardware on grill, directly to Monitor Mode.</p>
                                                </div>
                                            </div>
                                        </div>


                                    </div> <!-- End of list group body -->
                                </div><!-- End of card body -->
                                <div class="card-footer bg-secondary rounded mb-1 mt-3 py-1">
                                    <div class="row">
                                        <div class="col-12">
                                            <button type="submit" class="btn btn-danger mr-1">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div> <!-- End of Card -->
                    </div> <!-- End of Misc Tab -->
                    <!-- ============================ History Settings ========================== -->
                    <div class="tab-pane fade" id="v-pills-history" role="tabpanel" aria-labelledby="v-pills-history-tab">
                        <div class="card shadow">
                            <form name="history" action="/settings/history#v-pills-history" method="POST">
                                <div class="card-header bg-primary text-white">
                                    <h5>
                                        <i class="fas fa-tools"></i>&nbsp; History Settings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="list-group mb-1 shadow">
                                        <!-- History Auto Refresh Selector -->
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong class="mb-0"><i class="fas fa-sync-alt mr-2"></i>History Auto-Refresh</strong>
                                                </div>
                                                <div class="custom-control custom-switch d-flex justify-content-end">
                                                    <input type="checkbox" class="custom-control-input" id="historyautorefresh" name="historyautorefresh" {% if settings['history_page']['autorefresh'] == 'on' %}checked{% endif %}>
                                                    <label class="custom-control-label" for="historyautorefresh"></label>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- History To Display -->
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong><i class="fas fa-clock mr-2"></i>History to Display (mins)</strong>
                                                </div>
                                                <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                    <input id="historymins" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['history_page']['minutes'] }}" value="{{ settings['history_page']['minutes'] }}" name="historymins" style="min-width: 4ch;">
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Datapoints to Display -->
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong><i class="far fa-clock mr-2"></i>Datapoints to Display</strong>
                                                </div>
                                                <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                    <input id="datapoints" type="number" inputmode="numeric" min="10" class="form-control" placeholder="{{ settings['history_page']['datapoints'] }}" value="{{ settings['history_page']['datapoints'] }}" name="datapoints" style="min-width: 4ch;">
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Extended Data -->
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between mb-2">
                                                <div>
                                                    <strong><i class="fas fa-database mr-2"></i>Track Extended Data</strong>
                                                    <span class="badge badge-warning ml-2">DEBUG</span>
                                                </div>
                                                <div class="custom-control custom-switch d-flex justify-content-end">
                                                    <input type="checkbox" class="custom-control-input" id="ext_data" name="ext_data" {% if settings['globals']['ext_data'] %}checked{% endif %}>
                                                    <label class="custom-control-label" for="ext_data"></label>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <p class="text-muted mb-0">Extended data is stored in the database, and exported to cookfile/CSV files for debug purposes. This setting can only be changed when the grill is inactive (i.e. 'Stop' mode).</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>                                  
                                    <!-- Collapsible Card -->
                                    <div class="card shadow-sm mb-3 mt-3">
                                        <div class="btn bg-primary justify-content-between align-items-center" data-toggle="collapse" data-target="#collapseColors" aria-expanded="false" aria-controls="collapseColors" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    <i class="fas fa-palette mr-2"></i>
                                                    Color Config
                                                </div>
                                                <i class="fas fa-chevron-down"></i>
                                            </h5>
                                        </div>
                                        <div class="collapse" id="collapseColors">
                                            <div class="p-2 mt-2 mb-0">
                                                <div class="form-group mx-auto mb-2 p-0 border border-primary rounded col-12 order-lg-3">
                                                    <div class="bg-primary d-flex pl-2 mr-auto align-items-center">
                                                        <h5 class="mb-0 d-flex justify-content-between align-items-center pt-1 pb-1">
                                                            <i class="fas fa-exclamation-circle text-white mr-2"></i>
                                                            <span><b>NOTE:</b></span>
                                                        </h5>
                                                    </div>
                                                    <div class="rounded bg-secondary text-gray-dark p-2 text-wrap">
                                                        Click on the color swatch on the right of each line item to use the integrated color picker. Configure the line color and background color for each Probe, Probe Notification Target, and for Primary Probes, the Setpoint.
                                                    </div>
                                                </div>
                                            </div> 
                                            <div class="p-2 mt-2 mb-0">                                            
                                                {% for probe in settings['history_page']['probe_config'] %}
                                                <div class="border border-primary rounded position-relative pt-3 pb-2 mt-5">
                                                    <label class="border border-primary rounded px-2" style="font-size:1.2em; position: absolute; top: -15px; left: 10px; background-color: var(--gray-dark);">
                                                        <span class="fa fa-palette mr-2"><i></i></span>{{ settings['history_page']['probe_config'][probe]['name'] }}
                                                    </label>
                                                    <div class="row pt-1">
                                                        <div class="col-12 col-lg-6">
                                                            <div class="input-group" id="clrpck_temp_{{ probe }}" data-color="{{ settings['history_page']['probe_config'][probe]['line_color'] }}">
                                                                <div class="col-12 pt-2">
                                                                    <label for="clr_temp_{{ probe }}" data-toggle="tooltip" title="Adjust Temperature Color for {{ settings['history_page']['probe_config'][probe]['name'] }}">
                                                                    Temperature Color
                                                                    </label>
                                                                </div>
                                                                <div class="input-group-prepend col-12">
                                                                    <input type="text" inputmode="text" id="clr_temp_{{ probe }}" name="clr_temp_{{ probe }}" class="form-control input-lg" style="min-width: 11ch;">
                                                                    <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-12 col-lg-6">
                                                            <div class="input-group" id="clrpck_bgtemp_{{ probe }}" data-color="{{ settings['history_page']['probe_config'][probe]['bg_color'] }}">
                                                                <div class="col-12 pt-2">
                                                                    <label for="clrbg_temp_{{ probe }}" data-toggle="tooltip" title="Adjust Background Temperature Color for {{ settings['history_page']['probe_config'][probe]['name'] }}">
                                                                        Background Temperature Color
                                                                    </label>
                                                                </div>
                                                                <div class="input-group-prepend col-12">
                                                                    <input type="text" inputmode="text" id="clrbg_temp_{{ probe }}" name="clrbg_temp_{{ probe }}" class="form-control input-lg" style="min-width: 11ch;">
                                                                    <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {% if 'line_color_setpoint' in settings['history_page']['probe_config'][probe].keys() %} 
                                                    <div class="row"> 
                                                        <div class="col-12 col-lg-6">
                                                            <div class="input-group" id="clrpck_setpoint_{{ probe }}" data-color="{{ settings['history_page']['probe_config'][probe]['line_color_setpoint'] }}">
                                                                <div class="col-12 pt-2">
                                                                    <label for="clr_setpoint_{{ probe }}" data-toggle="tooltip" title="Adjust Setpoint Color for {{ settings['history_page']['probe_config'][probe]['name'] }}">
                                                                        Setpoint Color
                                                                    </label>
                                                                </div>
                                                                <div class="input-group-prepend col-12">
                                                                    <input type="text" inputmode="text" id="clr_setpoint_{{ probe }}" name="clr_setpoint_{{ probe }}" class="form-control input-lg" style="min-width: 11ch;">
                                                                    <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-12 col-lg-6">
                                                            <div class="input-group" id="clrpck_bgsetpoint_{{ probe }}" data-color="{{ settings['history_page']['probe_config'][probe]['bg_color_setpoint'] }}">
                                                                <div class="col-12 pt-2">
                                                                    <label for="clrbg_setpoint_{{ probe }}" data-toggle="tooltip" title="Adjust Background Setpoint Color for {{ settings['history_page']['probe_config'][probe]['name'] }}">
                                                                        Background Setpoint Color
                                                                    </label>
                                                                </div>
                                                                <div class="input-group-prepend col-12">
                                                                    <input type="text" inputmode="text" id="clrbg_setpoint_{{ probe }}" name="clrbg_setpoint_{{ probe }}" class="form-control input-lg" style="min-width: 11ch;">
                                                                    <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>  
                                                    {% endif %}
                                                    <div class="row"> 
                                                        <div class="col-12 col-lg-6">
                                                            <div class="input-group" id="clrpck_target_{{ probe }}" data-color="{{ settings['history_page']['probe_config'][probe]['line_color_target'] }}">
                                                                <div class="col-12 pt-2">
                                                                    <label for="clr_target_{{ probe }}" data-toggle="tooltip" title="Adjust Notify Target Color for {{ settings['history_page']['probe_config'][probe]['name'] }}">
                                                                        Notify Target Color
                                                                    </label>
                                                                </div>
                                                                <div class="input-group-prepend col-12">
                                                                    <input type="text" inputmode="text" id="clr_target_{{ probe }}" name="clr_target_{{ probe }}" class="form-control input-lg" style="min-width: 11ch;">
                                                                    <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-12 col-lg-6">
                                                            <div class="input-group" id="clrpck_bgtarget_{{ probe }}" data-color="{{ settings['history_page']['probe_config'][probe]['bg_color_target'] }}">
                                                                <div class="col-12 pt-2">
                                                                    <label for="clrbg_target_{{ probe }}" data-toggle="tooltip" title="Adjust Background Notify Target Color for {{ settings['history_page']['probe_config'][probe]['name'] }}">
                                                                        Background Notify Target Color
                                                                    </label>
                                                                </div>
                                                                <div class="input-group-prepend col-12">
                                                                    <input type="text" inputmode="text" id="clrbg_target_{{ probe }}" name="clrbg_target_{{ probe }}" class="form-control input-lg" style="min-width: 11ch;">
                                                                    <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>  
                                                </div>
                                                {% endfor %}
                                            </div>
                                        </div> <!-- End of collapse -->
                                    </div> <!-- End of Color Picker Card -->
                                </div> <!-- End of card body -->
                                <div class="card-footer bg-secondary rounded mb-1 py-1">
                                    <div class="row">
                                        <div class="col-12">
                                            <button type="submit" class="btn btn-danger mr-1">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div><!-- End of Card -->
                    </div><!-- End of History Tab -->
                    <!-- ========================== Notification Settings ========================== -->
                    <div class="tab-pane fade" id="v-pills-notifications" role="tabpanel" aria-labelledby="v-pills-notifications-tab">
                        <div class="card shadow">
                            <form name="notify" action="/settings/notify#v-pills-notifications" method="POST">
                                <div class="card-header bg-primary text-white">
                                    <h5>
                                        <i class="far fa-bell mr-2"></i>Notification Settings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <!-- App Push Notifications -->
                                    <div class="card shadow-sm mt-2 mb-2">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" data-toggle="collapse" data-target="#collapsePushNotifications" aria-expanded="false" aria-controls="collapsePushNotifications" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    App Push Notifications
                                                    <i class="fas fa-chevron-down ml-2"></i>
                                                </div>
                                                {% if settings['notify_services']['onesignal']['enabled'] %}
                                                <span class="badge badge-success">ON</span>
                                                {% else %}
                                                <span class="badge badge-danger">OFF</span>
                                                {% endif %}
                                            </h5>
                                        </div>
                                        <div class="collapse" id="collapsePushNotifications">
                                            <div class="list-group">
                                                <!-- Android Notifications Enable Selector -->
                                                <div class="list-group-item border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-sync-alt mr-2"></i>Enable OneSignal Notifications</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="onesignal_enabled" name="onesignal_enabled" {% if settings['notify_services']['onesignal']['enabled'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="onesignal_enabled"></label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-group-item p-1">
                                                    {% for index, data in settings['notify_services']['onesignal']['devices'].items()|sort %}
                                                    <div class="card shadow-sm mt-1 mb-1">
                                                        <div class="btn bg-secondary col-12 justify-content-between align-items-center" data-toggle="collapse" data-target="#edit_device{{ index }}" aria-expanded="false" aria-controls="edit_device{{ index }}" style="cursor: pointer;">
                                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                                <div class="d-flex align-items-start text-primary">
                                                                    {% if data['friendly_name'] == '' %}
                                                                    {{ data['device_name'] }}
                                                                    {% else %}
                                                                    {{ data['friendly_name'] }}
                                                                    {% endif %}
                                                                    <i class="fas fa-chevron-down ml-2 text-primary"></i>
                                                                </div>
                                                            </h5>
                                                        </div>
                                                        <div id="edit_device{{ index }}" class="collapse">
                                                            <div class="list-group mb-1 shadow">
                                                                <!-- Friendly Name -->
                                                                <div class="list-group-item">
                                                                    <div class="row">
                                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                                            <strong><i class="fas fa-user-circle mr-2"></i>Friendly Name</strong>
                                                                        </div>
                                                                        <div class="col-12 col-lg-9">
                                                                            <input id="FriendlyName_{{ index }}" type="text" inputmode="text" class="form-control" value="{{ data['friendly_name'] }}" name="FriendlyName_{{ index }}">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- Device Name -->
                                                                <div class="list-group-item">
                                                                    <div class="row">
                                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                                            <strong><i class="fas fa-user-circle mr-2"></i>Device Name</strong>
                                                                        </div>
                                                                        <div class="col-12 col-lg-9">
                                                                            <input id="DeviceName_{{ index }}" type="text" inputmode="text" class="form-control" value="{{ data['device_name'] }}" name="DeviceName_{{ index }}" readonly>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- App Version -->
                                                                <div class="list-group-item">
                                                                    <div class="row">
                                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                                            <strong><i class="fas fa-info-circle mr-2"></i>App Version</strong>
                                                                        </div>
                                                                        <div class="col-12 col-lg-9">
                                                                            <input id="AppVersion_{{ index }}" type="text" inputmode="text" class="form-control" value="{{ data['app_version'] }}" name="AppVersion_{{ index }}" readonly>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- OneSignal Device ID -->
                                                                <div class="list-group-item">
                                                                    <div class="row">
                                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                                            <strong><i class="fas fa-fingerprint mr-2"></i>OneSignal Device ID</strong>
                                                                        </div>
                                                                        <div class="col-12 col-lg-9">
                                                                            <input id="DeviceID_{{ index }}" type="text" inputmode="text" class="form-control" value="{{ index }}" name="DeviceID_{{ index }}" disabled>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="list-group-item bg-light pl-2 pt-1 pb-1">
                                                                    <button type="submit" class="btn btn-danger" name="edit_device" value="{{ index }}">Save</button>
                                                                    <!-- Button to Open the Modal -->
                                                                    <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#DeleteDeviceModal{{ index }}">Delete</button>
                                                                    <!-- The Modal -->
                                                                    <div class="modal fade" id="DeleteDeviceModal{{ index }}" data-backdrop="false">
                                                                        <div class="modal-dialog modal-dialog-centered col-12 col-lg-6 mx-auto">
                                                                            <div class="modal-content shadow-lg border rounded border-danger">
                                                                                <!-- Modal Header -->
                                                                                <div class="modal-header bg-danger">
                                                                                    {% if data['friendly_name'] == '' %}
                                                                                    <h4 class="modal-title">Delete Device {{ data['device_name'] }}</h4>
                                                                                    {% else %}
                                                                                    <h4 class="modal-title">Delete Device {{ data['friendly_name'] }}</h4>
                                                                                    {% endif %}
                                                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                                </div>
                                                                                <!-- Modal body -->
                                                                                {% if data['friendly_name'] == '' %}
                                                                                <div class="modal-body"> Are you sure you want to delete the {{ data['device_name'] }} device?</div>
                                                                                {% else %}
                                                                                <div class="modal-body"> Are you sure you want to delete the {{ data['friendly_name'] }} device?</div>
                                                                                {% endif %}
                                                                                <!-- Modal footer -->
                                                                                <div class="modal-footer list-group-item bg-light pl-2 pt-1 pb-1">
                                                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                                                    <button type="submit" class="btn btn-danger" name="delete_device" value="{{ index }}">Delete</button>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {% endfor %}
                                                </div>
                                                
                                                <div class="list-group-item">
                                                    <span class="badge badge-note mr-2">NOTE</span><span class="text-muted">App can be downloaded from Github.</span><span class="text-muted ml-2 mr-2">-</span><a href="https://github.com/weberbox/PiFire-Android" target="_blank"><b>Download</b></a>
                                                </div>
                                            </div><!-- End List Group -->
                                        </div><!-- End of card body -->
                                    </div> <!-- End of App Push Notifications Section -->
                                    <!-- Apprise Notifications -->
                                    <div class="card shadow-sm mb-2">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" data-toggle="collapse" data-target="#collapseApprise" aria-expanded="false" aria-controls="collapseApprise" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    Apprise Notifications
                                                    <i class="fas fa-chevron-down ml-2"></i>
                                                </div>
                                                {% if settings['notify_services']['apprise']['enabled'] == True %}
                                                <span class="badge badge-success">ON</span>
                                                {% else %}
                                                <span class="badge badge-danger">OFF</span>
                                                {% endif %}
                                            </h5>
                                        </div>
                                        <div class="collapse" id="collapseApprise">
                                            <div class="list-group">
                                                <!-- Apprise Enable Selector -->
                                                <div class="list-group-item border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-sync-alt mr-2"></i>Enable Apprise</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="apprise_enabled" name="apprise_enabled" {% if settings['notify_services']['apprise']['enabled'] == True %}checked{% endif %}>
                                                            <label class="custom-control-label" for="apprise_enabled"></label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Apprise Locations-->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-link mr-2"></i>Locations<span class="text-muted ml-2 mr-2">-</span><a href="https://github.com/caronc/apprise?tab=readme-ov-file#productivity-based-notifications" target="_blank">Help</a></strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <button type="button" name="appriseAddLocation" class="btn btn-success"><i class="fas fa-plus"></i></button>
                                                        </div>
                                                    </div>
                                                    <div class="row pt-3"></div>
                                                    {% if settings['notify_services']['apprise']['locations']|length %}
                                                    {% for location in settings['notify_services']['apprise']['locations'] %}
                                                    <div class="d-flex align-items-center justify-content-between mb-2 appriselocation">
                                                        <div class="d-flex justify-content-start flex-grow-1">
                                                            <input id="appriselocations" type="text" inputmode="text" class="form-control" name="appriselocations" value="{{location}}" placeholder="format://user@location/authorization">
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <button type="button" name="appriseDeleteLocation" class="btn btn-danger"><i class="fas fa-minus"></i></button>
                                                        </div>
                                                    </div>
                                                    {% endfor %}
                                                    {% else %}
                                                    <div class="d-flex align-items-center justify-content-between mb-2 appriselocation">
                                                        <div class="d-flex justify-content-start flex-grow-1">
                                                            <input id="appriselocations" type="text" inputmode="text" class="form-control" name="appriselocations" value="" placeholder="format://user@location/authorization">
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <button type="button" name="appriseDeleteLocation" class="btn btn-danger"><i class="fas fa-minus"></i></button>
                                                        </div>
                                                    </div>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <!-- End of card body -->
                                        </div>
                                    </div> <!-- End of Apprise Section -->
                                    <!-- IFTTT WebHooks -->
                                    <div class="card shadow-sm mb-2">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" data-toggle="collapse" data-target="#collapseIFTTT" aria-expanded="false" aria-controls="collapseIfttt" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    IFTTT WebHooks
                                                    <i class="fas fa-chevron-down ml-2"></i>
                                                </div>
                                                {% if settings['notify_services']['ifttt']['enabled'] %}
                                                <span class="badge badge-success">ON</span>
                                                {% else %}
                                                <span class="badge badge-danger">OFF</span>
                                                {% endif %}
                                            </h5>
                                        </div>
                                        <div class="collapse" id="collapseIFTTT">
                                            <div class="list-group">
                                                <!-- IFTTT Enable Selector -->
                                                <div class="list-group-item border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-sync-alt mr-2"></i>Enable IFTTT</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="ifttt_enabled" name="ifttt_enabled" {% if settings['notify_services']['ifttt']['enabled'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="ifttt_enabled"></label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- IFTTT API Key -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-key mr-2"></i>API Key<span class="text-muted ml-2 mr-2">-</span><a href="https://www.home-assistant.io/integrations/ifttt/#sending-events-to-ifttt" target="_blank">Help</a></strong>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div class="d-flex justify-content-start flex-grow-1">
                                                            <input id="iftttapi" type="text" inputmode="text" class="form-control" value="{{settings['notify_services']['ifttt']['APIKey']}}" name="iftttapi">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mb-1 mt-1"><b>My Applets > Webhooks > Settings</b></p>
                                                            <p class="text-muted mb-0">It is the last part of the URL. (e.g.  https://maker.ifttt.com/use/<b>MYAPIKEY</b>)</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div><!-- End of card body -->
                                        </div><!-- End of Card -->
                                    </div> <!-- End of IFTTT Section -->
                                    <!-- InfluxDB Notifications -->
                                    <div class="card shadow-sm mb-2">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" data-toggle="collapse" data-target="#collapseInfluxDB" aria-expanded="false" aria-controls="collapseInfluxDB" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    InfluxDB
                                                    <i class="fas fa-chevron-down ml-2"></i>
                                                </div>
                                                {% if settings['notify_services']['influxdb']['enabled'] %}
                                                <span class="badge badge-success">ON</span>
                                                {% else %}
                                                <span class="badge badge-danger">OFF</span>
                                                {% endif %}
                                            </h5>
                                        </div>
                                        <div class="collapse" id="collapseInfluxDB">
                                            <div class="list-group">
                                                <!-- InfluxDB Enable Selector -->
                                                <div class="list-group-item  border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-sync-alt mr-2"></i>Enable InfluxDB</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="influxdb_enabled" name="influxdb_enabled" {% if settings['notify_services']['influxdb']['enabled'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="influxdb_enabled"></label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- InfluxDB URL -->
                                                <div class="list-group-item">
                                                    <div class="row align-items-center">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-key mr-2"></i>URL</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="influxdb_url" type="text" inputmode="text" class="form-control" name="influxdb_url" value="{{settings['notify_services']['influxdb']['url']}}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- InfluxDB Token -->
                                                <div class="list-group-item">
                                                    <div class="row align-items-center">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-key mr-2"></i>Token</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="influxdb_token" type="text" inputmode="text" class="form-control" name="influxdb_token" value="{{settings['notify_services']['influxdb']['token']}}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- InfluxDB Org -->
                                                <div class="list-group-item">
                                                    <div class="row align-items-center">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-key mr-2"></i>Org</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="influxdb_org" type="text" inputmode="text" class="form-control" name="influxdb_org" value="{{settings['notify_services']['influxdb']['org']}}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- InfluxDB Bucket -->
                                                <div class="list-group-item">
                                                    <div class="row align-items-center">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-key mr-2"></i>Bucket</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="influxdb_bucket" type="text" inputmode="text" class="form-control" name="influxdb_bucket" value="{{settings['notify_services']['influxdb']['bucket']}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div><!-- End of card body -->
                                        </div><!-- End of Card -->
                                    </div> <!-- End of InfluxDB Section -->
                                    <!-- Pushbullet Notifications -->
                                    <div class="card shadow-sm mb-2">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" data-toggle="collapse" data-target="#collapsePushbullet" aria-expanded="false" aria-controls="collapsePushbullet" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    Pushbullet
                                                    <i class="fas fa-chevron-down ml-2"></i>
                                                </div>
                                                {% if settings['notify_services']['pushbullet']['enabled'] %}
                                                <span class="badge badge-success">ON</span>
                                                {% else %}
                                                <span class="badge badge-danger">OFF</span>
                                                {% endif %}
                                            </h5>
                                        </div>
                                        <div class="collapse" id="collapsePushbullet">
                                            <div class="list-group">
                                                <!-- Pushbullet Enable Selector -->
                                                <div class="list-group-item  border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-sync-alt mr-2"></i>Enable Pushbullet</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="pushbullet_enabled" name="pushbullet_enabled" {% if settings['notify_services']['pushbullet']['enabled'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="pushbullet_enabled"></label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Pushbullet API Key -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-key mr-2"></i>API Key<span class="text-muted ml-2 mr-2">-</span><a href="https://docs.pushbullet.com/#authentication"target="_blank">Help</a></strong>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div class="d-flex justify-content-start flex-grow-1">
                                                            <input id="pushbullet_apikey" type="text" inputmode="text" class="form-control" name="pushbullet_apikey" value="{{settings['notify_services']['pushbullet']['APIKey']}}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Pushbullet Public URL -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-link mr-2"></i>Public URL</strong>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div class="d-flex justify-content-start flex-grow-1">
                                                            <input id="pushbullet_publicurl" type="text" inputmode="text" class="form-control" name="pushbullet_publicurl" value="{{settings['notify_services']['pushbullet']['PublicURL']}}">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mt-1 mb-0 p-2">URL to be added to Pushbullet notifications.</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div><!-- End of card body -->
                                    </div><!-- End of Pushbullet Notifications -->
                                    <!-- PushOver Notifications -->
                                    <div class="card shadow-sm mb-2">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" data-toggle="collapse" data-target="#collapsePushOver" aria-expanded="false" aria-controls="collapsePushOver" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    PushOver
                                                    <i class="fas fa-chevron-down ml-2"></i>
                                                </div>
                                                {% if settings['notify_services']['pushover']['enabled'] %}
                                                <span class="badge badge-success">ON</span>
                                                {% else %}
                                                <span class="badge badge-danger">OFF</span>
                                                {% endif %}
                                            </h5>
                                        </div>
                                        <div class="collapse" id="collapsePushOver">
                                            <div class="list-group">
                                                <!-- PushOver Enable Selector -->
                                                <div class="list-group-item  border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-sync-alt mr-2"></i>Enable PushOver</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="pushover_enabled" name="pushover_enabled" {% if settings['notify_services']['pushover']['enabled'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="pushover_enabled"></label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- PushOver API Key -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-key mr-2"></i>API Key<span class="text-muted ml-2 mr-2">-</span><a href="https://www.make.com/en/help/app/pushover#:~:text=Log%20in%20to%20your%20Pushover,Create%20an%20Application%2FAPI%20Token." target="_blank">Help</a></strong>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div class="d-flex justify-content-start flex-grow-1">
                                                            <input id="pushover_apikey" type="text" inputmode="text" class="form-control" value="{{settings['notify_services']['pushover']['APIKey']}}" name="pushover_apikey">
                                                        </div>
                                                    </div>
                                                    
                                                </div>
                                                <!-- PushOver User Keys -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-key mr-2"></i>User Keys</strong>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div class="d-flex justify-content-start flex-grow-1">
                                                            <input id="pushover_userkeys" type="text" inputmode="text" class="form-control" value="{{settings['notify_services']['pushover']['UserKeys']}}" name="pushover_userkeys">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                           <p class="text-muted mt-1 mb-0 p-2"><span class="badge badge-note mr-2">NOTE</span> Separate multiple user keys with commas. Leave blank to disable.</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- PushOver Public URL -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-link mr-2"></i>Public URL</strong>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex align-items-center justify-content-between mb-2">
                                                        <div class="d-flex justify-content-start flex-grow-1">
                                                            <input id="pushover_publicurl" type="text" inputmode="text" class="form-control" name="pushover_publicurl" value="{{settings['notify_services']['pushover']['PublicURL']}}">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mt-1 mb-0 p-2">URL to be added to Pushover notifications.</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div><!-- End of card body -->
                                    </div><!-- End of PushOver Notifications -->  
                                    <!-- MQTT -->
                                    <div class="card shadow-sm mb-0">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" data-toggle="collapse" data-target="#collapseMQTT" aria-expanded="false" aria-controls="collapseMQTT" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    MQTT
                                                    <i class="fas fa-chevron-down ml-2"></i>
                                                </div>
                                                {% if settings['notify_services']['mqtt']['enabled'] %}
                                                <span class="badge badge-success">ON</span>
                                                {% else %}
                                                <span class="badge badge-danger">OFF</span>
                                                {% endif %}
                                            </h5>
                                        </div>
                                        <div class="collapse" id="collapseMQTT">
                                            <div class="list-group">
                                                <!-- MQTT Enable Selector -->
                                                <div class="list-group-item border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-sync-alt mr-2"></i>Enable MQTT</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="mqtt_enabled" name="mqtt_enabled" {% if settings['notify_services']['mqtt']['enabled'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="mqtt_enabled"></label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- MQTT ID -->
                                                <div class="list-group-item">
                                                    <div class="row align-items-center">
                                                        <div class="col-12 col-lg-7 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-key mr-2"></i>PiFire Unique ID</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-5">
                                                            <input id="mqtt_id" type="text" inputmode="text" class="form-control" name="mqtt_id" value="{{settings['notify_services']['mqtt']['id']}}">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <b>Enter a unique name for this instance of PiFire.</b>
                                                            </p>
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <span class="badge badge-note mr-2">NOTE</span>
                                                                This name is used as the root mqtt topic for this device.  Changing
                                                                it later will result in new mqtt topics being created, and if using Home Assistant 
                                                                will result in new sensors being created. 
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- MQTT Broker -->
                                                <div class="list-group-item">
                                                    <div class="row align-items-center">
                                                        <div class="col-12 col-lg-7 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-link mr-2"></i>MQTT Broker Address</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-5">
                                                            <input id="mqtt_broker" type="text" inputmode="text" class="form-control" name="mqtt_broker" value="{{settings['notify_services']['mqtt']['broker']}}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- MQTT Port -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-link mr-2"></i>MQTT Port</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="mqtt_port" type="text" inputmode="numeric" class="form-control" placeholder="{{ settings['notify_services']['mqtt']['port'] }}" value="{{ settings['notify_services']['mqtt']['port'] }}" name="mqtt_port" style="min-width: 4ch;">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <b>Default:</b> 1883
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- MQTT Username -->
                                                <div class="list-group-item">
                                                    <div class="row align-items-center">
                                                        <div class="col-12 col-lg-8 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-key mr-2"></i>Username</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-4">
                                                            <input id="mqtt_user" type="text" class="form-control" name="mqtt_user" value="{{settings['notify_services']['mqtt']['username']}}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- MQTT Password -->
                                                <div class="list-group-item">
                                                    <div class="row align-items-center">
                                                        <div class="col-12 col-lg-8 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-key mr-2"></i>Password</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-4">
                                                            <input id="mqtt_pw" type="text" class="form-control" name="mqtt_pw" value="{{settings['notify_services']['mqtt']['password']}}">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <span class="badge badge-note mr-2">NOTE</span>
                                                                If your broker does not require authentication, leave blank.
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- MQTT Refresh Rate -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-clock mr-2"></i>Refresh Rate (sec)</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="mqtt_freq" type="number" inputmode="numeric" class="form-control" placeholder="{{ settings['notify_services']['mqtt']['update_sec'] }}" value="{{ settings['notify_services']['mqtt']['update_sec'] }}" name="mqtt_freq" style="min-width: 4ch;">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <b>Default:</b> 30
                                                            </p>
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                Specify in seconds, how often you would like to publish PiFire data to the mqtt broker.
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- MQTT Home Assistant Discovery Topic -->
                                                <div class="list-group-item">
                                                    <div class="row align-items-center">
                                                        <div class="col-12 col-lg-8 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-wand-magic-sparkles mr-2"></i>Home Assistant Discovery Topic</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-4">
                                                            <input id="mqtt_auto_d" type="text" class="form-control" name="mqtt_auto_d" value="{{settings['notify_services']['mqtt']['homeassistant_autodiscovery_topic']}}">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <b>Default:</b> homeassistant or homie
                                                            </p>
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <span class="badge badge-note mr-2">NOTE</span>
                                                                The <a href="https://www.home-assistant.io/integrations/mqtt/" target="blank"><b>Home Asstant MQTT integration</b></a> can automatically
                                                                add PiFire and its devices if you specify the discovery topic name here.
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div><!-- End of card body -->
                                        </div><!-- End of Card -->
                                    </div><!-- End of MQTT Section -->
                                    <div class="p-2 mt-2 mb-0">
                                        <div class="form-group mx-auto mb-2 p-0 border border-primary rounded col-12 order-lg-3">
                                            <div class="bg-primary d-flex pl-2 mr-auto align-items-center">
                                                <h5 class="mb-0 d-flex justify-content-between align-items-center pt-1 pb-1">
                                                    <i class="fas fa-exclamation-circle text-white mr-2"></i>
                                                    <span><b>NOTE:</b></span>
                                                </h5>
                                            </div>
                                            <div class="rounded text-gray-dark p-2 text-wrap">
                                                You must enable the service(s) and 'Save' before you can test the service(s).
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-footer bg-secondary rounded mb-1 py-1">
                                        <div class="row">
                                            <div class="col-lg-8">
                                                <button type="submit" class="btn btn-danger mr-1">Save</button>
                                                <button type="button" class="btn btn-success mr-1" onclick="sendTestNotification();">Send Test Notification</button>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- End of Card Body -->
                            </form>
                        </div><!-- End of Card Body -->
                    </div><!-- End of Notification Tab -->
                    <!-- ============================ Pellet Settings ========================== -->
                    <div class="tab-pane fade" id="v-pills-pellets" role="tabpanel" aria-labelledby="v-pills-pellets-tab">
                        <div class="card shadow">
                            <form name="pelletsettings" action="/settings/pellets#v-pills-pellets" method="POST">
                                <div class="card-header bg-primary text-white">
                                    <h5>
                                        <i class="fas fa-tools"></i>&nbsp; Pellet Settings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="list-group mb-1 shadow">
                                        <div class="card shadow-sm mt-2 mb-2">
                                            <div class="btn bg-secondary section-header justify-content-between align-items-center">
                                                <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                    <div class="d-flex align-items-start">
                                                        Pellet Level Warnings
                                                    </div>
                                                    {% if settings['pelletlevel']['warning_enabled'] %}
                                                    <span class="badge badge-success">ON</span>
                                                    {% else %}
                                                    <span class="badge badge-danger">OFF</span>
                                                    {% endif %}
                                                </h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="list-group-item border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-exclamation-triangle mr-2"></i>Pellet Level Warning</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="pellet_warning" name="pellet_warning" {% if settings['pelletlevel']['warning_enabled'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="pellet_warning"></label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Check Time -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="far fa-clock mr-2"></i>Check Time (mins)</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="warning_time" type="number" inputmode="numeric" min="5" max="240" class="form-control" placeholder="{{ settings['pelletlevel']['warning_time'] }}" value="{{ settings['pelletlevel']['warning_time'] }}" name="warning_time" style="min-width: 4ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Level Warning -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-exclamation-triangle mr-2"></i>Level Warning (%)</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="warning_level" type="number" inputmode="numeric" min="0" max="100" class="form-control" placeholder="{{ settings['pelletlevel']['warning_level'] }}" value="{{ settings['pelletlevel']['warning_level'] }}" name="warning_level" style="min-width: 4ch;">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <span class="badge badge-note mr-2">NOTE</span>
                                                                Pellet levels below the input percent will receive notifications every {{ settings['pelletlevel']['warning_time'] }} minutes during a cook.
                                                            </p>
                                                        </div>
                                                    </div>  
                                                </div>
                                            </div><!-- End of card body -->
                                        </div><!-- End of Card -->
                                    </div><!-- End of List Group -->
                                    <div class="list-group mb-1 shadow">
                                        <div class="card shadow-sm mt-2 mb-2">
                                            <div class="btn bg-secondary section-header justify-content-between align-items-center" style="cursor: pointer;">
                                                <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                    <div class="d-flex align-items-start">
                                                        Hopper Sensor Configuration
                                                    </div>
                                                </h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-level-up-alt mr-2"></i>Hopper Full Distance (cm)</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="full" type="number" inputmode="numeric" min="0" max="100" class="form-control" placeholder="{{ settings['pelletlevel']['full'] }}" value="{{ settings['pelletlevel']['full'] }}" name="full" style="min-width: 4ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-level-down-alt mr-2"></i>Hopper Empty Distance (cm)</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="empty" type="number" inputmode="numeric" min="1" max="100" class="form-control" placeholder="{{ settings['pelletlevel']['empty'] }}" value="{{ settings['pelletlevel']['empty'] }}" name="empty" style="min-width: 4ch;">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <span class="badge badge-note mr-2">NOTE</span>
                                                                The distance value for full must be smaller than the value for empty.
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div><!-- End of card body -->
                                        </div><!-- End of Card -->
                                    </div><!-- End of List Group -->
                                    <div class="list-group mb-1 shadow">
                                        <div class="card shadow-sm mt-2 mb-2">
                                            <div class="btn bg-secondary section-header justify-content-between align-items-center" style="cursor: pointer;">
                                                <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                    <div class="d-flex align-items-start">
                                                        Auger Feed Rate
                                                    </div>
                                                </h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong class="mb-0"><i class="fas fa-angle-double-right mr-2"></i>Auger Rate (g/s)</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="auger_rate" type="number" inputmode="numeric" min="0" step="0.05" class="form-control" placeholder="{{ settings['globals']['augerrate'] }}" value="{{ settings['globals']['augerrate'] }}" name="auger_rate" style="min-width: 4ch;">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <b>Value used to:</b>
                                                                    <ul>
                                                                        <li class="text-muted">Calculate how long to run auger during priming.</li>
                                                                        <li class="text-muted">Calculate estimated pellet usage.</li>
                                                                    </ul>
                                                            </p>
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                This value can be tuned for your auger speed, by going into manual mode and running the auger for 10 seconds, then weighing the pellets
                                                                that have been dispensed into the firepot.  
                                                            </p>
                                                            <p class="text-muted mb-0 ml-2 p-2">
                                                                <i><b>Example:</b> If you run the auger for 10 seconds and 3 grams of pellets are dispensed, then
                                                                the calculation would be 3g / 10s = 0.3.  That means 0.3 grams are dispensed per second of auger on time.
                                                                </i>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div><!-- End of card body -->
                                        </div><!-- End of Card -->
                                    </div><!-- End of List Group -->
                                    
                                </div><!-- End of card body -->
                                <div class="card-footer bg-secondary rounded mb-1 mt-3 py-1">
                                    <div class="row">
                                        <div class="col-12">
                                            <button type="submit" class="btn btn-danger mr-1">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div><!-- End of Card -->
                    </div><!-- End of Pellet Tab -->
                    <!-- ============================ Probe Profiles ========================== -->
                    <div class="tab-pane fade" id="v-pills-probes" role="tabpanel" aria-labelledby="v-pills-probes-tab">
                        <div class="card shadow">
                            <div class="card-header bg-primary text-white">
                                <h5>
                                    <i class="fas fa-thermometer mr-2"></i>Probe Profile Selection
                                </h5>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="card shadow">
                                    <div class="card-body">
                                    <!-- Probe Settings Form Start -->
                                    <form name="probe_type_input" id="probe_form" action="/settings/probes#v-pills-probes" method="POST">
                                        <div class="list-group mb-1 shadow">
                                            {% for probe in settings['probe_settings']['probe_map']['probe_info'] %}
                                            <div class="list-group-item">
                                                <div class="row align-items-center">
                                                    <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                                                        <div class="d-flex justify-content-between justify-content-lg-start align-items-center">
                                                            <div class="order-0 order-lg-1">
                                                                <i class="fas fa-thermometer d-lg-none mr-2"></i><strong>{{ probe['name'] }}</strong>&nbsp; Probe Profile  
                                                            </div>
                                                            <div class="order-1 order-lg-0 mr-lg-3">
                                                                <button type="button" class="btn btn-success btn-sm" data-toggle="modal" data-backdrop="false" data-target="#renameModal_{{ probe['label'] }}">
                                                                    <i class="fas fa-pen"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                                                        <select class="form-control" name="profile_select_{{ probe['label'] }}" id="profile_select_{{ probe['label'] }}">
                                                            {% for index, data in settings['probe_settings']['probe_profiles'].items()|sort %}
                                                            <option value="{{ index }}" {% if data['id'] == probe['profile']['id'] %} selected{% endif %}>{{ data['name'] }}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Modal -->
                                            <div class="modal fade" id="renameModal_{{ probe['label'] }}" tabindex="-1" role="dialog" aria-labelledby="renameModalLabel_{{ probe['label'] }}" aria-hidden="true">
                                                <div class="modal-dialog modal-dialog-centered" role="document">
                                                    <div class="modal-content shadow-lg border rounded border-success">
                                                        <div class="modal-header bg-success">
                                                            <h5 class="modal-title" id="renameModalLabel_{{ probe['label'] }}">Rename <b>{{ probe['label'] }}</b> Probe</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="col-12">
                                                                <input id="probe_name_{{ probe['label'] }}" type="text" inputmode="text" class="form-control" name="probe_name_{{ probe['label'] }}" value="{{ probe['name'] }}" inputmode="text" style="min-width: 11ch;">
                                                            </div>
                                                        </div>
                                                        <div class="modal-footer list-group-item bg-light pl-2 pt-1 pb-1">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                            <button type="button" class="btn btn-danger" onclick="document.getElementById('probe_form').submit();">Save</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            {% endfor %}
                                        </div>
                                        <div class="card-footer bg-secondary rounded mb-1 mt-3 py-1">
                                            <div class="row">
                                                <div class="col-12">
                                                    <button type="submit" class="btn btn-danger mr-1">Save</button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div><!-- End of card body -->
                            </div><!-- End of Probe Types Card -->
                        </div><!-- End of Probe Settings Card body -->
                        <div class="card shadow mt-4">
                            <div class="card-header bg-primary text-white">
                                <h5>
                                    <i class="fa-solid fa-file-circle-plus mr-2"></i>Probe Profile Manager
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="card shadow">
                                    <form name="addprofile" action="/settings/addprofile" method="POST">
                                        <div class="d-flex flex-column flex-lg-row justify-content-between bg-secondary rounded p-2">
                                            <div class="btn btn-primary col-12 col-lg-5 ml-lg-4 order-lg-1 order-2 d-flex justify-content-center align-items-center mt-2 mt-lg-1 mb-lg-1" data-toggle="collapse" data-target="#addprofile" aria-expanded="false" aria-controls="addprofile" style="cursor: pointer;">
                                                <h5 class="mb-0 d-flex justify-content-center align-items-center">
                                                    <i class="fas fa-plus-circle mr-2"></i>Add Profile
                                                    <i class="fas fa-chevron-down ml-2"></i>
                                                </h5>
                                            </div>
                                            <a href="/tuner" class="btn btn-warning col-12 col-lg-5 mr-lg-4 order-lg-2 order-1 d-flex justify-content-center align-items-center mt-2 mt-lg-1 mb-lg-1" role="button">
                                                <h5 class="mb-0 d-flex justify-content-center align-items-center">
                                                    <i class="fa-solid fa-tools mr-2"></i>Tuner Tools
                                                </h5>
                                            </a>
                                        </div>
                                        <div id="addprofile" class="collapse">
                                            <div class="list-group mb-1 shadow">
                                                <!-- Name -->
                                                <div class="list-group-item">
                                                    <div class="row">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-user-circle mr-2"></i>Name</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="Name" type="text" inputmode="text" class="form-control" placeholder="Name" name="Name" required style="min-width: 11ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- CoEff A -->
                                                <div class="list-group-item">
                                                    <div class="row">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-calculator mr-2"></i>CoEff A</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="A" type="text" inputmode="numeric" class="form-control" name="A" required style="min-width: 11ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- CoEff B -->
                                                <div class="list-group-item">
                                                    <div class="row">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-calculator mr-2"></i>CoEff B</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="B" type="text" inputmode="numeric" class="form-control" name="B" required style="min-width: 11ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- CoEff C -->
                                                <div class="list-group-item">
                                                    <div class="row">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-calculator mr-2"></i>CoEff C</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="C" type="text" inputmode="numeric" class="form-control" name="C" required style="min-width: 11ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="list-group-item bg-light pl-2 pt-1 pb-1">
                                                <button type="submit" class="btn btn-danger">Save</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <div class="card-body">
                            {% for index, data in settings['probe_settings']['probe_profiles'].items()|sort %}
                                <div class="card shadow-sm mt-1 mb-1">
                                    <form name="editprofile" action="/settings/editprofile" method="POST">
                                        <div class="btn bg-secondary col-12 justify-content-between align-items-center" data-toggle="collapse" data-target="#edit{{ index }}" aria-expanded="false" aria-controls="edit{{ index }}" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start" style="max-width: 80%;">
                                                    <div class="text-primary text-truncate">
                                                        {{ data['name'] }}
                                                    </div>
                                                    <i class="fas fa-chevron-down ml-2 text-primary"></i>
                                                </div>
                                                <div class="ml-auto mr-1">
                                                    {% for probe in settings['probe_settings']['probe_map']['probe_info'] %}
                                                        {% if data['name'] == probe['profile']['name'] %}
                                                            <span class="badge badge-success ml-1">{{ probe['label'] }}</span>
                                                        {% endif %}
                                                    {% endfor %}
                                                </div>
                                            </h5>
                                        </div>
                                        <div id="edit{{ index }}" class="collapse">
                                            <div class="list-group mb-1 shadow">
                                                <!-- Name -->
                                                <div class="list-group-item">
                                                    <div class="row">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-user-circle mr-2"></i>Name</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="Name_{{ index }}" type="text" inputmode="text" class="form-control" value="{{ data['name'] }}" name="Name_{{ index }}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- CoEff A -->
                                                <div class="list-group-item">
                                                    <div class="row">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-calculator mr-2"></i>CoEff A</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="A_{{ index }}" type="text" inputmode="numeric" class="form-control" value="{{ data['A'] }}" name="A_{{ index }}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- CoEff B -->
                                                <div class="list-group-item">
                                                    <div class="row">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-calculator mr-2"></i>CoEff B</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="B_{{ index }}" type="text" inputmode="numeric" class="form-control" value="{{ data['B'] }}" name="B_{{ index }}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- CoEff C -->
                                                <div class="list-group-item">
                                                    <div class="row">
                                                        <div class="col-12 col-lg-3 mb-1 mb-lg-0">
                                                            <strong><i class="fas fa-calculator mr-2"></i>CoEff C</strong>
                                                        </div>
                                                        <div class="col-12 col-lg-9">
                                                            <input id="C_{{ index }}" type="text" inputmode="numeric" class="form-control" value="{{ data['C'] }}" name="C_{{ index }}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="list-group-item bg-light pl-2 pt-1 pb-1">
                                                <button type="submit" class="btn btn-danger" name="editprofile" value="{{ index }}">Save</button>
                                                <!-- Button to Open the Modal -->
                                                <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#DeleteProfileModal{{ index }}">Delete</button>
                                                <!-- The Modal -->
                                                <div class="modal fade" id="DeleteProfileModal{{ index }}" data-backdrop="false">
                                                    <div class="modal-dialog modal-dialog-centered col-12 col-lg-6 mx-auto">
                                                        <div class="modal-content shadow-lg border rounded border-danger">
                                                            <!-- Modal Header -->
                                                            <div class="modal-header bg-danger">
                                                                <h4 class="modal-title">Delete Profile {{ data['name'] }}</h4>
                                                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                            </div>
                                                            <!-- Modal body -->
                                                            <div class="modal-body"> Are you sure you want to delete the {{ data['name'] }} profile?</div>
                                                            <!-- Modal footer -->
                                                            <div class="modal-footer list-group-item bg-light pl-2 pt-1 pb-1">
                                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                                <button type="submit" class="btn btn-danger" name="delete" value="{{ index }}">Delete</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                {% endfor %}
                            </div><!-- End of card body -->
                        </div><!-- End of Card -->
                    </div><!-- End of Probe Profiles Tab -->
                    <!-- ============================ PWM Settings ========================== -->
                    {% if settings['globals']['dc_fan'] %}
                    <div class="tab-pane fade" id="v-pills-pwm" role="tabpanel" aria-labelledby="v-pills-pwm-tab">
                        <div class="card shadow">
                            <form name="pwm" action="/settings/pwm#v-pills-pwm" method="POST">
                                <div class="card-header bg-primary text-white">
                                    <h5>
                                        <i class="fas fa-tools mr-2"></i>PWM Settings
                                    </h5>
                                </div>
                                <div class="card shadow-sm mt-2 mb-2">
                                    <div class="p-2 rounded bg-secondary justify-content-between align-items-center">
                                        <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                            <div class="d-flex align-items-start">
                                                PWM Temp Control Settings
                                            </div>
                                            {% if settings['pwm']['pwm_control'] %}
                                            <div class="d-flex justify-content-end">
                                                <span class="badge badge-warning">ON</span>
                                            </div>
                                            {% else %}
                                            <span class="badge badge-danger">OFF</span>
                                            {% endif %}
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="list-group-item border border-success rounded">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong class="mb-0"><i class="fas fa-angle-double-right mr-2"></i>Temp Control Enabled by Default</strong>
                                                </div>
                                                <div class="custom-control custom-switch d-flex justify-content-end">
                                                    <input type="checkbox" class="custom-control-input" id="pwm_control" name="pwm_control" {% if settings['pwm']['pwm_control'] %}checked{% endif %}>
                                                    <label class="custom-control-label" for="pwm_control"></label>
                                                </div>
                                            </div>
                                            <p class="text-muted mb-0 ml-2 p-2">
                                                <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                If enabled, PWM Temp Control will override Smoke Plus fan ramping. The fan will adjust with temperature and cycle on and off but will not ramp up to speed.
                                            </p>
                                        </div>
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong><i class="far fa-clock mr-2"></i>Update Time (s)</strong>
                                                </div>
                                                <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                    <input id="pwm_update" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['pwm']['update_time'] }}" value="{{ settings['pwm']['update_time'] }}" name="pwm_update">
                                                </div>
                                            </div>
                                            <p class="text-muted mb-0 ml-2 p-2">
                                                <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                If Current Grill Temp is over Set Temp Fan will be set to Minimum Duty Cycle. If the Grill temp is below the Set Temp the Duty Cycles below will be used. Example: If Current Grill Temp drops below Set Temp by 1-3  a 20% PWM will be set. If the Grill Temp drops below the Set Temp by 15 a 75% Duty Cycle will be set.
                                            </p>
                                        </div>
                                        <div class="list-group-item">
                                            <div class="col-lg-8 col-md-10 col-sm-12 mr-auto p-0 ">
                                                <div class="mb-3">
                                                    <strong><i class="fas fa-history mr-2"></i>Duty Cycle Settings</strong>
                                                </div>
                                                <table class="table table-sm border border-secondary rounded ml-lg-3" id="duty_cycle_table">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">Action</th>
                                                            <th scope="col">Temp Range</th>
                                                            <th scope="col">Duty Cycle</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    </tbody>
                                                    <tfoot>
                                                        <tr>
                                                            <td>
                                                                <button type="button" class="btn btn-success btn-sm" data-toggle="modal" data-target="#dc_add_modal"><i class="fas fa-plus"></i></button>
                                                            </td>
                                                            <td></td>
                                                            <td></td>
                                                        </tr>
                                                    </tfoot>
                                                </table>
                                            </div>
                                        </div>
                                        <!-- Temp Fan Control Profile modal -->
                                        <div class="modal fade" id="dc_add_modal" data-backdrop="false" tabindex="-1" aria-labelledby="dc_add_modal_label" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered" role="document">
                                                <div class="modal-content shadow-lg border rounded border-warning">
                                                    <div class="modal-header bg-warning">
                                                        <h5 class="modal-title" id="dc_add_modal_label">Add PWM Temp Profile</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="list-group">
                                                        <div class="list-group-item">
                                                            <p class="mt-1 mb-0 p-2">
                                                                <span class="badge badge-note mr-2">NOTE</span>
                                                                Enter a Temp Range Value > <span id="dc_add_temp">0</span>{{ settings['globals']['units'] }}
                                                            </p>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="d-flex align-items-center justify-content-between">
                                                                <div>
                                                                    <strong class="mb-0" id="dc_temp_label">Temp Range ({{ settings['globals']['units'] }})</strong>
                                                                </div>
                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                    <input type="number" inputmode="numeric" class="form-control" value="5" min="1" max="100" name="dc_temp" id="dc_temp" aria-label="Temp Range" aria-describedby="dc_temp_label" style="min-width: 4ch;">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="d-flex align-items-center justify-content-between">
                                                                <div>
                                                                    <strong class="mb-0" id="dc_duty_cycle_label">Duty Cycle (%)</strong>
                                                                </div>
                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                    <input type="number" inputmode="numeric" class="form-control" value="50" min="1" max="100" name="dc_duty_cycle" id="dc_duty_cycle" aria-label="Duty Cycle" aria-describedby="dc_duty_cycle_label" style="min-width: 4ch;">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer list-group-item bg-light pl-2 pt-1 pb-1">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                        <button type="button" class="btn btn-danger" data-dismiss="modal" onClick="onAddPWM()">Save</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div><!-- End of Add Modal-->
                                        <!-- Temp Fan Control Edit Profile modal -->
                                        
                                        <div class="modal fade" id="dc_edit_modal" data-backdrop="false" tabindex="-1" aria-labelledby="dc_edit_modal_label" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered" role="document">
                                                <div class="modal-content shadow-lg border rounded border-warning">
                                                    <div class="modal-header bg-warning">
                                                        <h5 class="modal-title" id="dc_edit_modal_label">Edit PWM Temp Profile</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="list-group">
                                                        <div class="list-group-item">
                                                            <p class="mt-1 mb-0 p-2">
                                                                <span class="badge badge-note mr-2">NOTE</span>
                                                                <span id="dc_edit_range_text">Enter a Temp Range Value of&nbsp;<span id="dc_edit_range_min">0</span> - <span id="dc_edit_range_max">6</span> &deg;F</span>
                                                            </p>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="d-flex align-items-center justify-content-between">
                                                                <div>
                                                                    <strong class="mb-0" id="dc_edit_temp_label">Temp Range ({{ settings['globals']['units'] }})</strong>
                                                                </div>
                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                    <input type="number" inputmode="numeric" class="form-control" value="55" min="0" max="200" name="dc_edit_temp" id="dc_edit_temp" aria-label="Temp Range" aria-describedby="dc_edit_temp_label" style="min-width: 4ch;">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="d-flex align-items-center justify-content-between">
                                                                <div>
                                                                    <strong class="mb-0" id="dc_edit_duty_cycle_label">Duty Cycle (%)</strong>
                                                                </div>
                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                    <input type="number" inputmode="numeric" class="form-control" value="50" min="1" max="100" name="dc_edit_duty_cycle" id="dc_edit_duty_cycle" aria-label="Duty Cycle" aria-describedby="dc_edit_duty_cycle_label" style="min-width: 4ch;">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer list-group-item bg-light pl-2 pt-1 pb-1">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                        <button type="button" class="btn btn-danger" id="dc_save_edits" value="" data-dismiss="modal" onClick="saveChangesPWM(this.value)">Save</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div><!-- End of Edit Modal-->
                                    </div>
                                </div>
                                <div class="card shadow">
                                    <div class="p-2 rounded bg-secondary justify-content-between align-items-center">
                                        <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                            <div class="d-flex align-items-start">
                                                <i class="fas fa-tools"></i>&nbsp; General Fan Settings
                                            </div>
                                        </h5>
                                    </div>
                                    <div class="list-group">
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong class="mb-0"><i class="fas fa-wave-square mr-2"></i>Frequency (Hz)</strong>
                                                </div>
                                                <div class="col-4 col-lg-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                    <input id="frequency" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['pwm']['frequency'] }}" value="{{ settings['pwm']['frequency'] }}" name="frequency">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong><i class="fas fa-tachometer-alt mr-2"></i>Min Duty Cycle</strong>
                                                </div>
                                                <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                    <input id="min_duty_cycle" type="number" inputmode="numeric" min="1" max="100" class="form-control" placeholder="{{ settings['pwm']['min_duty_cycle'] }}" value="{{ settings['pwm']['min_duty_cycle'] }}" name="min_duty_cycle">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="list-group-item">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong><i class="fas fa-tachometer-alt mr-2"></i>Max Duty Cycle</strong>
                                                </div>
                                                <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                    <input id="max_duty_cycle" type="number" inputmode="numeric" min="50" max="100" class="form-control" placeholder="{{ settings['pwm']['max_duty_cycle'] }}" value="{{ settings['pwm']['max_duty_cycle'] }}" name="max_duty_cycle">
                                                </div>
                                            </div>
                                        </div>
                                    </div> <!-- End of card body -->
                                </div>
                                <div class="card-footer bg-secondary rounded mb-1 mt-3 py-1">
                                    <div class="row">
                                        <div class="col-12">
                                            <button type="submit" class="btn btn-danger mr-1">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div> <!-- End of Card -->
                    </div>
                    {% endif %}
                    <!-- End of PWM Tab -->
                    <!-- ============================ Safety Settings ========================== -->
                    <div class="tab-pane fade" id="v-pills-safety" role="tabpanel" aria-labelledby="v-pills-safety-tab">
                        <div class="card shadow">
                            <form name="safetysettings" action="/settings/safety#v-pills-safety" method="POST">
                                <div class="card-header bg-primary text-white">
                                    <h5>
                                        <i class="fas fa-tools mr-2"></i>Safety Settings
                                    </h5>
                                </div>
                                <div class="list-group">
                                    <div class="p-2 mt-2 mb-0">
                                        <div class="form-group mx-auto mb-2 p-2 border border-secondary bg-danger rounded col-12 order-lg-3">
                                            <div class="bg-danger p-2 d-flex justify-content-center align-items-center text-center">
                                                <h5 class="mb-0 pt-1 pb-1">
                                                    <i class="fas fa-exclamation-triangle text-white mr-2"></i>
                                                    <span><b>WARNING</b></span>
                                                    <i class="fas fa-exclamation-triangle text-white ml-2"></i>
                                                </h5>
                                            </div>
                                            <div class="rounded bg-danger p-2 text-wrap text-center text-white">
                                                <p class=""><b>Safety features are not infallible and may not prevent safety issues with your grill in all cases.</b></p>
                                                <p class="mt-1 mb-1">It is the operator's responsibility to monitor their equipment to ensure proper operational safety.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="list-group-item border border-success rounded">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div>
                                                <strong class="mb-0"><i class="fas fa-check-circle mr-2"></i>Enable Startup Check</strong>
                                            </div>
                                            <div class="col-4 col-lg-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                <div class="custom-control custom-switch">
                                                    <input type="checkbox" class="custom-control-input" id="startup_check" name="startup_check" {% if settings['safety']['startup_check'] %}checked{% endif %}>
                                                    <label class="custom-control-label" for="startup_check"></label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between">
                                            <p class="text-muted mt-1 mb-0 p-2">
                                                <span class="badge badge-note mr-2">NOTE</span>
                                                Enables an additional check after clicking startup, to prevent accidental startup.
                                            </p>
                                        </div>
                                    </div>
                                    <div class="list-group-item">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div>
                                                <strong class="mb-0"><i class="fas fa-temperature-high mr-2"></i>Min Startup Temp (&deg;{{settings['globals']['units']}})</strong>
                                            </div>
                                            <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                <input id="minstartuptemp" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['safety']['minstartuptemp'] }}" value="{{ settings['safety']['minstartuptemp'] }}" name="minstartuptemp">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="list-group-item">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div>
                                                <strong><i class="fas fa-temperature-high mr-2"></i>Max Startup Temp (&deg;{{settings['globals']['units']}})</strong>
                                            </div>
                                            <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                <input id="maxstartuptemp" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['safety']['maxstartuptemp'] }}" value="{{ settings['safety']['maxstartuptemp'] }}" name="maxstartuptemp">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="list-group-item">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div>
                                                <strong><i class="fas fa-redo-alt mr-2"></i>Reignite Retries</strong>
                                            </div>
                                            <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                <input id="reigniteretries" type="number" inputmode="numeric" min="0" max="10" class="form-control" placeholder="{{ settings['safety']['reigniteretries'] }}" value="{{ settings['safety']['reigniteretries'] }}" name="reigniteretries">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="list-group-item">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div>
                                                <strong><i class="fas fa-temperature-high mr-2"></i>Max Operational Temp (&deg;{{settings['globals']['units']}})</strong>
                                            </div>
                                            <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                <input id="maxtemp" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['safety']['maxtemp'] }}" value="{{ settings['safety']['maxtemp'] }}" name="maxtemp">
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col">
                                                <p class="text-muted mb-0 ml-2 p-2">
                                                    <span class="badge badge-note mr-2">NOTE</span>
                                                    <ul>
                                                        <li class="text-muted">In an error condition (temp too low, temp too high) the grill will immediately shutdown and log the error in the events log.</li>
                                                        <li class="text-muted">Notifications of an error will be sent if enabled.</li>
                                                        <li class="text-muted">The Max Temp safety setting is also enabled in Monitor mode.</li>
                                                    </ul>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- End of card body -->
                                <div class="card-footer bg-secondary rounded mb-1 mt-3 py-1">
                                    <div class="row">
                                        <div class="col-12">
                                            <button type="submit" class="btn btn-danger mr-1">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div><!-- End of Card -->
                    </div><!-- End of Safety Tab -->
                    <!-- ============================ Startup/Shutdown Settings ========================== -->
                    <div class="tab-pane fade" id="v-pills-startup" role="tabpanel" aria-labelledby="v-pills-startup-tab">
                        <div class="card shadow">
                            <form name="startup_shutdown_settings" action="/settings/startup#v-pills-startup" method="POST">
                                <div class="card-header bg-primary text-white">
                                    <h5>
                                        <i class="fas fa-tools mr-2"></i>Startup & Shutdown Settings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <!-- Startup Settings -->
                                    <div class="card shadow-sm mt-2 mb-2">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" data-toggle="collapse" data-target="#collapsePrime" aria-expanded="false" aria-controls="collapsePrime" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    <i class="fas fa-angle-double-right mr-2"></i>Prime During Startup
                                                    <i class="fas fa-chevron-down ml-2"></i>
                                                </div>
                                                <div class="d-flex justify-content-end">
                                                    {% if settings['globals']['prime_ignition'] %}
                                                        <div class="mr-2">
                                                            <span class="badge badge-danger d-none d-lg-inline">IGNITER</span>
                                                            <span class="badge badge-danger d-inline d-lg-none">IGN</span>
                                                        </div>
                                                    {% endif %}
                                                    {% if settings['startup']['prime_on_startup'] > 0 %}
                                                        <div>
                                                            <span class="badge badge-warning d-none d-lg-inline">PRIME {{ settings['startup']['prime_on_startup'] }}g</span>
                                                            <span class="badge badge-warning d-inline d-lg-none">{{ settings['startup']['prime_on_startup'] }}g</span>
                                                        </div>
                                                    {% endif %}
                                                    {% if settings['startup']['prime_on_startup'] == 0 and not settings['globals']['prime_ignition'] %}
                                                        <div>
                                                            <span class="badge badge-success">OFF</span>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                            </h5>
                                        </div>
                                        <div class="collapse" id="collapsePrime">
                                            <div class="card-body">
                                                <!-- Primer Auger  -->
                                                <div class="list-group-item border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fa-solid fa-angles-right mr-2"></i>Prime on Startup</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="prime_on_startup_toggle" {% if settings['startup']['prime_on_startup'] > 0 %}checked{% endif %}>
                                                            <label class="custom-control-label" for="prime_on_startup_toggle"></label>
                                                        </div>
                                                    </div>
                                                    <div id="prime_on_startup_input" class="list-group-item rounded mt-2 p-1 bg-light" style="display: {% if settings['startup']['prime_on_startup'] == 0 %}none{% else %}block{% endif %};">
                                                        <div class="d-flex align-items-center justify-content-between">
                                                            <strong><i class="fa-solid fa-angles-right mr-2"></i>Prime Amount (grams)</strong>
                                                            <div class="col-3 col-lg-2 ml-auto mr-0 pr-0">
                                                                <input id="prime_on_startup" type="number" inputmode="numeric" min="0" max="200" class="form-control" value="{{ settings['startup']['prime_on_startup'] }}" name="prime_on_startup">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="mb-2"></div>
                                                <!-- Run Igniter  -->
                                                <div class="border rounded border-danger">
                                                    <div class="list-group-item bg-danger">
                                                        <div class="d-flex align-items-center justify-content-between">
                                                            <div>
                                                                <strong class="mb-0"><i class="fas fa-angle-double-right mr-2"></i>Enable Igniter During Prime</strong>
                                                            </div>
                                                            <div class="custom-control custom-switch d-flex justify-content-end">
                                                                <input type="checkbox" class="custom-control-input" id="prime_ignition" name="prime_ignition" {% if settings['globals']['prime_ignition'] %}checked{% endif %}>
                                                                <label class="custom-control-label" for="prime_ignition"></label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="list-group-item">
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <span class="badge badge-danger mr-2">DANGER</span>
                                                            <b>Only enable the igniter during priming, if you are absolutely sure that you need to do this.</b>
                                                        </p>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            Enabling the igniter will ignite pellets and start the firepot, even without the fan enabled. 
                                                            This feature will only turn on the igniter if Prime & Startup is selected.  Otherwise, priming 
                                                            without startup will not utilize the igniter. 
                                                        </p>
                                                    </div>
                                                </div>
                                            </div><!-- End of card body -->
                                        </div><!-- End of Card -->
                                    </div><!-- End of List Group -->
                                    <!-- Default Startup Settings -->
                                    <div class="card shadow">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    <i class="fas fa-play mr-2"></i>Startup Settings
                                                </div>
                                                <div class="d-flex justify-content-end">
                                                    {% if settings['startup']['smartstart']['enabled'] %}
                                                        <div>
                                                            <span class="badge badge-success"><i class="fas fa-brain mr-2"></i>SMART</span>
                                                        </div>
                                                    {% else %}
                                                        
                                                    {% endif %}
                                                </div>
                                            </h5>
                                        </div>
                                        <div class="list-group">
                                            <!-- Smart Start Enabled -->
                                            <div class="list-group-item border rounded border-success">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div>
                                                        <strong><i class="fas fa-sync-alt mr-2"></i>Smart Start</strong>
                                                    </div>
                                                    <div class="custom-control custom-switch d-flex justify-content-end">
                                                        <input type="checkbox" class="custom-control-input" id="smartstart_enable" name="smartstart_enable" {% if settings['startup']['smartstart']['enabled'] %}checked{% endif %}>
                                                        <label class="custom-control-label" for="smartstart_enable"></label>
                                                    </div>
                                                </div>
                                                <div>
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                        <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                        Smart Start will sample the temperature from your grill temperature probe on startup to determine the startup mode time and the Smoke mode cycle settings. If this mode is enabled, it will override the above startup and smoke cycle settings. Edit the profiles below to customize the behavior of startup.
                                                </div>
                                            </div>
                                            <!-- Startup Duration -->
                                            <div class="list-group-item" id="startup_duration" style="display: {% if settings['startup']['smartstart']['enabled'] %}none{% else %}block{% endif %};">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div>
                                                        <strong class="mb-0"><i class="fas fa-clock mr-2"></i>Startup Duration (seconds)</strong>
                                                    </div>
                                                    <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                        <input id="startup_duration" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['startup']['duration'] }}" value="{{ settings['startup']['duration'] }}" name="startup_duration" style="min-width: 4ch;">
                                                    </div>
                                                </div>
                                                <p class="text-muted mb-0 ml-2 p-2">
                                                    <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                    Amount of time for startup before transitioning to next mode or attempting a reignite
                                                </p>
                                            </div>
                                            <!-- Exit at Temp -->
                                            <div class="list-group-item" id="exit_at_temp" style="display: {% if settings['startup']['smartstart']['enabled'] %}none{% else %}block{% endif %};">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div>
                                                        <strong><i class="fas fa-temperature-high mr-2"></i>Auto Exit Startup at Temperature</strong>
                                                    </div>
                                                    <div class="custom-control custom-switch d-flex justify-content-end">
                                                        <input type="checkbox" class="custom-control-input" id="startup_exit_temp_toggle" {% if settings['startup']['startup_exit_temp'] > 0 %}checked{% endif %}>
                                                        <label class="custom-control-label" for="startup_exit_temp_toggle"></label>
                                                    </div>
                                                </div>
                                                <div>
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                        <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                        If enabled, the grill will exit startup mode when the grill temperature reaches the set temperature.
                                                    </p>
                                                </div>
                                                <div id="startup_exit_temp_input" class="list-group-item rounded mt-2 p-1 bg-light" style="display: {% if settings['startup']['startup_exit_temp'] == 0 %}none{% else %}block{% endif %};">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <strong><i class="fas fa-temperature-high mr-2"></i>Exit Startup Temperature ({{ settings['globals']['units'] }})</strong>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0">
                                                            <input id="startup_exit_temp" type="number" inputmode="numeric" min="0" class="form-control" value="{{ settings['startup']['startup_exit_temp'] }}" name="startup_exit_temp" style="min-width: 4ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Go to Hold Mode on Startup-->
                                            <div class="list-group-item">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div>
                                                        <strong><i class="fa-solid fa-diamond-turn-right mr-2"></i>Exit Startup Mode to:</strong>
                                                    </div>
                                                    <div class="d-flex align-items-end">
                                                        <select class="custom-select" id="after_startup_mode" name="after_startup_mode" onchange="toggleHoldTemp()">
                                                            <option value="Smoke" {% if settings['startup']['start_to_mode']['after_startup_mode'] == 'Smoke' %}selected{% endif %}>Smoke Mode&nbsp;</option>
                                                            <option value="Hold" {% if settings['startup']['start_to_mode']['after_startup_mode'] == 'Hold' %}selected{% endif %}>Hold Mode&nbsp;</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <p class="text-muted mb-0 ml-2 p-2">
                                                    Select what mode to transition to after initial startup.
                                                </p>
                                                <p class="text-muted mb-0 ml-2 p-2">
                                                    <b>Default:</b> 'Smoke Mode'
                                                </p>
                                            </div>
                                            <!-- Hold Mode Set Temp on Startup-->
                                            <div class="list-group-item" id="holdTemp" style="display: none;">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div>
                                                        <strong class="mb-0"><i class="fas fa-temperature-low mr-2"></i>Hold Temp</strong>
                                                    </div>
                                                    <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                        <input id="startup_duration" type="number" inputmode="numeric" min="{{ settings['safety']['maxstartuptemp'] }}" max="{{ settings['safety']['maxtemp'] }}" class="form-control" value="{{ settings['startup']['start_to_mode']['primary_setpoint'] }}" name="startup_mode_setpoint" style="min-width: 4ch;">
                                                    </div>
                                                </div>
                                                <p class="text-muted mb-0 ml-2 p-2">
                                                    The initial Hold Mode Temperature setting after startup. 
                                                </p>
                                                <p class="text-muted mb-0 ml-2 p-2">
                                                    <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                    This setting is only used if Hold Mode is selected as the Startup Exit Mode. 
                                                </p>    
                                            </div>
                                        </div>
                                        <!-- Smart Start Settings -->
                                        <div class="card shadow-sm mt-2 mb-0" id="smartstart_settings" style="display: {% if settings['startup']['smartstart']['enabled'] %}flex{% else %}none{% endif %};">
                                            <div class="list-group">
                                                <div class="btn bg-secondary section-header justify-content-between align-items-center" aria-expanded="false" aria-controls="collapseSmartStart" style="cursor: pointer;">
                                                    <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                        <div class="d-flex align-items-start">
                                                            <i class="fas fa-brain mr-2"></i>Smart Start Settings
                                                        </div>
                                                    </h5>
                                                </div>
                                            </div>
                                            <div class="list-group">
                                                <!-- Smart Start Exit Temp -->
                                                <div>
                                                    <div class="list-group-item">
                                                        <div class="d-flex align-items-center justify-content-between">
                                                            <div>
                                                                <strong class="mb-0"><i class="fas fa-temperature-high mr-2"></i>Auto Exit Smart Startup at Temperature ({{ settings['globals']['units'] }})</strong>
                                                            </div>
                                                            <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                <input id="smartstart_exit_temp" type="number" inputmode="numeric" min="0" class="form-control" placeholder="{{ settings['startup']['smartstart']['exit_temp'] }}" value="{{ settings['startup']['smartstart']['exit_temp'] }}" name="smartstart_exit_temp" style="min-width: 4ch;">
                                                            </div>
                                                        </div>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                            Set this value to 0 to disable this startup exit temperature.
                                                        </p>
                                                    </div>
                                                    <div class="list-group-item">
                                                        <!-- Smart Start Profiles -->
                                                        <table class="table table-sm" id="smartStartTable">
                                                            <thead>
                                                                <tr>
                                                                <th scope="col">Action</th>
                                                                <th scope="col">Temp Range</th>
                                                                <th scope="col">Startup</th>
                                                                <th scope="col">AugerOn</th>
                                                                <th scope="col">P-Mode</th>
                                                            </tr>
                                                            </thead>
                                                            <tbody>
                                                            </tbody>
                                                            <tfoot>
                                                                <tr>
                                                                    <td>
                                                                        <button type="button" class="btn btn-success btn-sm" data-toggle="modal" data-target="#sstrt_add_modal"><i class="fas fa-plus"></i></button>
                                                                    </td>
                                                                    <td></td>
                                                                    <td></td>
                                                                    <td></td>
                                                                    <td></td>
                                                                </tr>
                                                            </tfoot>
                                                        </table>
                                                        <!-- Smart Start ADD Profile modal -->
                                                        <div class="modal fade" id="sstrt_add_modal" data-backdrop="false" tabindex="-1" aria-labelledby="sstrt_add_modal_label" aria-hidden="true">
                                                            <div class="modal-dialog modal-dialog-centered" role="document">
                                                                <div class="modal-content shadow-lg border rounded border-warning">
                                                                    <div class="modal-header bg-warning">
                                                                        <h5 class="modal-title" id="sstrt_add_modal_label">Add Smart Start Profile</h5>
                                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                            <span aria-hidden="true">&times;</span>
                                                                        </button>
                                                                    </div>
                                                                    <div class="list-group">
                                                                        <div class="col">
                                                                            <p class="mt-1 mb-0 p-2">
                                                                                <span class="badge badge-note mr-2">NOTE</span>
                                                                                <span id="add_RangeText">Enter a Temp Range Value > <span id="addMinTemp">0</span>{{ settings['globals']['units'] }}</span>
                                                                            </p>
                                                                        </div>
                                                                        <div class="list-group-item">
                                                                            <div class="d-flex align-items-center justify-content-between">
                                                                                <div>
                                                                                    <strong class="mb-0" id="minTempLabel">Min Temperature({{ settings['globals']['units'] }})</strong>
                                                                                </div>
                                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                                    <input type="number" inputmode="numeric" class="form-control" value="55" min="0" max="200" name="minTemp" id="minTemp" aria-label="Min Temperature" aria-describedby="minTempLabel" style="min-width: 4ch;">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="list-group-item">
                                                                            <div class="d-flex align-items-center justify-content-between">
                                                                                <div>
                                                                                    <strong class="mb-0" id="startupTimeLabel">Startup Time(s)</strong>
                                                                                </div>
                                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                                    <input type="number" inputmode="numeric" class="form-control" value="240" min="30" max="1200" name="startupTime" id="startupTime" aria-label="Startup Time" aria-describedby="startupTimeLabel" style="min-width: 5ch;">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="list-group-item">
                                                                            <div class="d-flex align-items-center justify-content-between">
                                                                                <div>
                                                                                    <strong class="mb-0" id="augeronTimeLabel">Auger On Time(s)</strong>
                                                                                </div>
                                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                                    <input type="number" inputmode="numeric" class="form-control" value="15" min="1" max="1000" name="augeronTime" id="augeronTime" aria-label="Auger On Time" aria-describedby="augeronTimeLabel" style="min-width: 5ch;">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="list-group-item">
                                                                            <div class="d-flex align-items-center justify-content-between">
                                                                                <div>
                                                                                    <strong class="mb-0" id="pModeLabel">P-Mode</strong>
                                                                                </div>
                                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                                    <input type="number" inputmode="numeric" class="form-control" value="2" min="0" max="9" name="pMode" id="pMode" aria-label="P-Mode" aria-describedby="pModeLabel" style="min-width: 3ch;">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="modal-footer list-group-item bg-light pl-2 pt-1 pb-1">
                                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                                        <button type="button" class="btn btn-danger" data-dismiss="modal" onClick="onAdd()">Save</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div><!-- End of Add Modal-->
                                                        <!-- Smart Start EDIT Profile modal -->
                                                        <div class="modal fade" id="sstrt_edit_modal" data-backdrop="false" tabindex="-1" aria-labelledby="sstrt_edit_modal_label" aria-hidden="true">
                                                            <div class="modal-dialog modal-dialog-centered" role="document">
                                                                <div class="modal-content shadow-lg border rounded border-warning">
                                                                    <div class="modal-header bg-warning">
                                                                        <h5 class="modal-title" id="sstrt_edit_modal_label">Edit Smart Start Profile</h5>
                                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                            <span aria-hidden="true">&times;</span>
                                                                        </button>
                                                                    </div>
                                                                    <div class="list-group">
                                                                        <div class="col">
                                                                            <p class="mt-1 mb-0 p-2">
                                                                                <span class="badge badge-note mr-2">NOTE</span>
                                                                                <span id="edit_RangeText">Enter a value in the range <span id="editRangeMin">0</span>-<span id="editRangeMax">200</span>{{ settings['globals']['units'] }}</span>
                                                                            </p>
                                                                        </div>
                                                                        <div class="list-group-item">
                                                                            <div class="d-flex align-items-center justify-content-between">
                                                                                <div>
                                                                                    <strong class="mb-0" id="edit_minTempLabel">Max Temperature({{ settings['globals']['units'] }})</strong>
                                                                                </div>
                                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                                    <input type="number" inputmode="numeric" class="form-control" value="55" min="0" max="200" name="edit_minTemp" id="edit_minTemp" aria-label="Min Temperature" aria-describedby="edit_minTempLabel" style="min-width: 4ch;">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="list-group-item">
                                                                            <div class="d-flex align-items-center justify-content-between">
                                                                                <div>
                                                                                    <strong class="mb-0" id="edit_startupTimeLabel">Startup Time(s)</strong>
                                                                                </div>
                                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                                    <input type="number" inputmode="numeric" class="form-control" value="240" min="30" max="1200" name="edit_startupTime" id="edit_startupTime" aria-label="Startup Time" aria-describedby="edit_startupTimeLabel" style="min-width: 5ch;">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="list-group-item">
                                                                            <div class="d-flex align-items-center justify-content-between">
                                                                                <div>
                                                                                    <strong class="mb-0" id="edit_augeronTimeLabel">Auger On Time(s)</strong>
                                                                                </div>
                                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                                    <input type="number" inputmode="numeric" class="form-control" value="15" min="1" max="1000" name="edit_augeronTime" id="edit_augeronTime" aria-label="Auger On Time" aria-describedby="edit_augeronTimeLabel" style="min-width: 5ch;">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="list-group-item">
                                                                            <div class="d-flex align-items-center justify-content-between">
                                                                                <div>
                                                                                    <strong class="mb-0" id="edit_pModeLabel">P-Mode</strong>
                                                                                </div>
                                                                                <div class="col-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                                    <input type="number" inputmode="numeric" class="form-control" value="2" min="0" max="9" name="edit_pMode" id="edit_pMode" aria-label="P-Mode" aria-describedby="edit_pModeLabel" style="min-width: 3ch;">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="modal-footer list-group-item bg-light pl-2 pt-1 pb-1">
                                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                                        <button type="button" class="btn btn-danger" id="saveEdits" value="" data-dismiss="modal" onClick="saveChanges(this.value)">Save</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div><!-- End of Edit Modal-->
                                                    </div><!-- End of Smart Start Settings Card Body -->
                                                </div><!-- End of Smart Start Settings Card-->
                                            </div>
                                        </div><!-- End of Smart Start Settings Card-->
                                    </div><!-- End of Start Settings body -->
                                    <!-- Shutdown Settings -->
                                    <!-- Default Shutdown Settings -->
                                    <div class="card shadow-sm mt-2 mb-2">
                                        <div class="btn bg-secondary section-header justify-content-between align-items-center" aria-expanded="false" aria-controls="collapseShutdown" style="cursor: pointer;">
                                            <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                                <div class="d-flex align-items-start">
                                                    <i class="fas fa-flag-checkered mr-2"></i>Shutdown Settings
                                                </div>
                                                {% if settings['shutdown']['auto_power_off'] %}
                                                    <div>
                                                        <span class="badge badge-warning"><i class="fab fa-raspberry-pi mr-2"></i>AUTO OFF</span>
                                                    </div>
                                                {% endif %}
                                            </h5>
                                        </div>
                                        <div class="card-body">
                                            <!-- Shutdown Duration -->
                                            <div class="list-group-item">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div>
                                                        <strong><i class="far fa-clock mr-2"></i>Shutdown Duration (seconds)</strong>
                                                    </div>
                                                    <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                        <input id="shutdown_duration" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['shutdown']['shutdown_duration'] }}" value="{{ settings['shutdown']['shutdown_duration'] }}" name="shutdown_duration" style="min-width: 4ch;">
                                                    </div>
                                                </div>
                                                <div>
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                        Amount of time fan will run after Shutdown Mode is selected.
                                                    </p>
                                                </div>
                                            </div>
                                            <!-- Auto Power Off -->
                                            <div class="list-group-item">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div>
                                                        <strong><i class="fas fa-power-off mr-2"></i>Auto Power Off</strong>
                                                    </div>
                                                    <div class="custom-control custom-switch d-flex justify-content-end">
                                                        <input type="checkbox" class="custom-control-input" id="auto_power_off" name="auto_power_off" {% if settings['shutdown']['auto_power_off'] %}checked{% endif %}>
                                                        <label class="custom-control-label" for="auto_power_off"></label>
                                                    </div>
                                                </div>
                                                <div>
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                        <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                        When enabled the system will auto power off after the Shutdown Mode has ended.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div> <!-- End of Shutdown Settings Card-->
                                </div><!-- End of card body -->
                                <div class="card-footer bg-secondary rounded mb-1 mt-2 py-1">
                                    <div class="row">
                                        <div class="col-12">
                                            <button type="submit" class="btn btn-danger mr-1">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div><!-- End of Card -->
                    </div><!-- End of Startup/Shutdown Tab -->
                    <!-- ============================ Work Mode Settings ========================== -->
                    <div class="tab-pane fade" id="v-pills-work-mode" role="tabpanel" aria-labelledby="v-pills-work-mode-tab">
                        <div class="card shadow">
                            <form name="cycle_settings" action="/settings/cycle#v-pills-work-mode" method="POST">
                                <div class="card-header bg-primary text-white">
                                    <h5>
                                        <i class="fas fa-tools mr-2"></i>Work Mode Settings
                                    </h5>
                                </div>
                                <!-- Lid Open Detection -->
                                <div class="card shadow-sm mt-2">
                                    <div class="btn bg-secondary section-header justify-content-between align-items-center flex-column flex-sm-row" data-toggle="collapse" data-target="#collapseLidOpen" aria-expanded="false" aria-controls="collapseLidOpen" style="cursor: pointer;">
                                        <h5 class="mb-0 d-flex justify-content-between align-items-center w-100 w-sm-auto">
                                            <div class="d-flex align-items-start">
                                                <i class="fas fa-door-open mr-2"></i>Lid Open Detection Settings (HOLD Mode)
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-chevron-down ml-2 mr-2"></i>
                                                <div>
                                                    {% if settings['cycle_data']['LidOpenDetectEnabled'] %}
                                                        <div>
                                                            <span class="badge badge-success">ON</span>
                                                        </div>
                                                    {% else %}
                                                        <div>
                                                            <span class="badge badge-danger">OFF</span>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </h5>
                                    </div>
                                    <div class="collapse" id="collapseLidOpen">
                                        <div class="card-body">
                                            <!-- Lid Open Detection Settings Body -->
                                            <div class="list-group">
                                                <div class="list-group-item border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-cog mr-2"></i>Auto Lid Open Detection</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="lid_open_detect_enable" name="lid_open_detect_enable" {% if settings['cycle_data']['LidOpenDetectEnabled'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="lid_open_detect_enable"></label>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <b>If enabled, the system will attempt to determine if the lid was opened and temporarily suspend the controller.</b>
                                                        </p>
                                                        <p class="text-muted mb-0 ml-2 p-2"> 
                                                            <span class="badge badge-note mr-2">NOTE</span>If the temperature drops below the threshold (percentage of the hold temperature), a lid open event is triggered.  
                                                            Once lid open is detected, it will pause the controller calculations for the Lid Open Pause Time.
                                                        </p>
                                                    </div>
                                                </div>
                                            
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-percent mr-2"></i>Lid Open Threshold Percentage</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="lid_open_threshold" type="number" inputmode="numeric" min="1" step="1" max="80" class="form-control" placeholder="{{ settings['cycle_data']['LidOpenThreshold'] }}" value="{{ settings['cycle_data']['LidOpenThreshold'] }}" name="lid_open_threshold" style="min-width: 5ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-clock mr-2"></i>Lid Open Pause Time (s)</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="lid_open_pausetime" inputmode="numeric" type="number" min="10" step="1" max="1000" class="form-control" placeholder="{{ settings['cycle_data']['LidOpenPauseTime'] }}" value="{{ settings['cycle_data']['LidOpenPauseTime'] }}" name="lid_open_pausetime" style="min-width: 5ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div><!-- End of list group -->
                                    </div> 
                                </div><!-- End of Lid Open Detection Card -->
                                <!-- Keep Warm Settings -->
                                <div class="card shadow-sm mt-2">
                                    <div class="btn bg-secondary section-header justify-content-between align-items-center flex-column flex-sm-row" data-toggle="collapse" data-target="#collapseKeepWarm" aria-expanded="false" aria-controls="collapseKeepWarm" style="cursor: pointer;">
                                        <h5 class="mb-0 d-flex justify-content-between align-items-center w-100 w-sm-auto">
                                            <div class="d-flex align-items-start">
                                                <i class="fas fa-tachometer-alt mr-2"></i>Keep Warm Settings
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-chevron-down ml-2 mr-2"></i>
                                                <div>
                                                    {% if settings['keep_warm']['s_plus'] %}
                                                        <div>
                                                            <span class="badge" style="background-color:blueviolet;">SMOKE+</span>
                                                        </div>
                                                    {% else %}
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </h5>
                                    </div>
                                    <div class="collapse" id="collapseKeepWarm">
                                        <div class="card-body">
                                            <!-- Keep Warm Settings Body -->
                                            <div class="list-group">
                                                <div class="list-group-item">
                                                    <div class="form-group mx-auto mb-2 p-0 border border-primary rounded col-12 order-lg-3">
                                                        <div class="bg-primary d-flex pl-2 mr-auto align-items-center">
                                                            <h5 class="mb-0 d-flex justify-content-between align-items-center pt-1 pb-1">
                                                                <i class="fas fa-exclamation-circle text-white mr-2"></i>
                                                                <span><b>NOTE:</b></span>
                                                            </h5>
                                                        </div>
                                                        <div class="rounded bg-secondary text-gray-dark p-2 text-wrap">
                                                            The Keep Warm mode is a specified Hold temperature, that you can define, <u>that can be activated by a timer or 
                                                            notification targets.</u>  When the grill is active, you can click on the timer dialog and check the Keep Warm 
                                                            box.  Or you can click on the Notification Targets for any of the probes and select the Keep Warm box. 
                                                            The Keep Warm function will be activated when a probe notify target has been achieved 
                                                            or the timer has expired. The Grill will exit the currently running mode and switch to Hold Mode then 
                                                            attempt to maintain the temperature set below.
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-temperature-high mr-2"></i>Keep Warm Temp ({{settings['globals']['units']}})</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="keep_warm_temp" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['keep_warm']['temp'] }}" value="{{ settings['keep_warm']['temp'] }}" name="keep_warm_temp" style="min-width: 5ch;">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-group-item">
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                        <span class="badge badge-note mr-2">NOTE</span>You can also enable or disable the Smoke Plus feature during Keep Warm.
                                                    </p>
                                                </div>
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-smog mr-2"></i>Smoke Plus Enabled During 'Keep Warm'</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="keep_warm_s_plus" name="keep_warm_s_plus" {% if settings['keep_warm']['s_plus'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="keep_warm_s_plus"></label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div><!-- End of list group -->
                                    </div><!-- End of card body -->
                                </div><!-- End of Card -->
                                <!-- Startup / Smoke Mode Cycle Settings -->
                                <div class="card shadow-sm mt-2">
                                    <div class="btn bg-secondary section-header justify-content-between align-items-center flex-column flex-sm-row" data-toggle="collapse" data-target="#collapseStartupSmoke" aria-expanded="false" aria-controls="collapseStartupSmoke" style="cursor: pointer;">
                                        <h5 class="mb-0 d-flex justify-content-between align-items-center w-100 w-sm-auto">
                                            <div class="d-flex align-items-start">
                                                <i class="fas fa-play mr-2"></i>Startup / Smoke Mode Cycle Settings
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-chevron-down ml-2 mr-2"></i>
                                                <div>
                                                    <span class="badge" style="background-color: fuchsia;">P-{{ settings['cycle_data']['PMode'] }}</span>
                                                </div>
                                            </div>
                                        </h5>
                                    </div>
                                    <div class="collapse" id="collapseStartupSmoke">
                                        <div class="card-body">
                                            <!-- Startup / Smoke Mode Cycle Settings Body -->
                                            <div class="list-group">
                                                <div class="form-group mx-auto mb-2 p-0 border border-primary rounded col-12 order-lg-3">
                                                    <div class="bg-primary d-flex pl-2 mr-auto align-items-center">
                                                        <h5 class="mb-0 d-flex justify-content-between align-items-center pt-1 pb-1">
                                                            <i class="fas fa-exclamation-circle text-white mr-2"></i>
                                                            <span><b>NOTE:</b></span>
                                                        </h5>
                                                    </div>
                                                    <div class="rounded bg-secondary text-gray-dark p-2 text-wrap">
                                                        During Startup and Smoke modes, the cycle time (Auger On Time + Auger Off Time) is fixed, and does not change dynamically based on any other inputs.
                                                        Effectively, this may allow you to adjust the rough smoke temperature depending other external factors like ambient temperature (seasonal), etc. <br><br>
                                                        The Auger On/Off Time can be configured here, to have a finer control over the cycle times.
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Auger On Time -->
                                            <div class="list-group-item">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div>
                                                        <strong><i class="far fa-clock mr-2"></i>Auger On Time</strong>
                                                    </div>
                                                    <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                        <input id="SmokeOnCycleTime" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['cycle_data']['SmokeOnCycleTime'] }}" value="{{ settings['cycle_data']['SmokeOnCycleTime'] }}" name="SmokeOnCycleTime" style="min-width: 5ch;">
                                                    </div>
                                                </div>
                                                <div>
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                       <b>Default:</b> 15
                                                   </p> 
                                                   <p class="text-muted mb-0 ml-2 p-2">
                                                       Auger-On Time for Smoke and Startup Modes (seconds).
                                                   </p>
                                               </div>
                                            </div>
                                            <!-- Auger Off Time -->
                                            <div class="list-group-item">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div>
                                                        <strong><i class="far fa-clock mr-2"></i>Auger Off Time</strong>
                                                    </div>
                                                    <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                        <input id="SmokeOffCycleTime" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['cycle_data']['SmokeOffCycleTime'] }}" value="{{ settings['cycle_data']['SmokeOffCycleTime'] }}" name="SmokeOffCycleTime" style="min-width: 5ch;">
                                                    </div>
                                                </div>
                                                <div>
                                                     <p class="text-muted mb-0 ml-2 p-2">
                                                        <b>Default:</b> 45
                                                    </p> 
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                        Auger-Off Time for Smoke and Startup Modes (seconds).
                                                    </p>
                                                </div>
                                            </div>
                                            <!-- P-Mode -->
                                            <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                            <div>
                                                                    <strong><i class="fas fa-cog mr-2"></i>P-Mode</strong><span class="text-muted ml-2 mr-2">-</span><a href="#" data-toggle="modal" data-target="#helpModal" data-backdrop="false">Table</a></strong>
                                                            </div>
                                                            <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                                <select id="pmode" class="form-control" name="pmode">
                                                                    {% for i in range(10) %}
                                                                        {% if i == 0 %}
                                                                            <option value="{{ i }}" {% if settings['cycle_data']['PMode'] == i %}selected{% endif %}>0 - OFF</option>
                                                                        {% elif i == 2 %}
                                                                            <option value="{{ i }}" {% if settings['cycle_data']['PMode'] == i %}selected{% endif %}>2 - Default</option>
                                                                        {% else %}
                                                                            <option value="{{ i }}" {% if settings['cycle_data']['PMode'] == i %}selected{% endif %}>{{ i }}</option>
                                                                        {% endif %}
                                                                    {% endfor %}
                                                                </select>
                                                            </div>
                                                    </div>
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                            P-Mode adds additional 10s for each increment to Auger Off Time for Startup and Smoke Modes.
                                                    </p>  
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                            <b>[Total Auger Off Time]</b> = [Auger Off Time] + (P-Mode &times; 10)
                                                    </p>  
                                                    <p class="text-muted mb-0 ml-2 p-2 align-items-center">
                                                            <span class="badge badge-note mr-2">NOTE</span>
                                                            <b class="text-light">Smart Start</b></a> ignores P-Mode Settings on Startup.</i>
                                                    </p>
                                                    <p class="text-muted mb-0 ml-2 p-2 align-items-center">
                                                        <span class="badge badge-note mr-2">NOTE</span>
                                                        <b class="text-light">Hold Mode</b> ignores P-Mode Settings.</i>
                                                    </p>
                                                    <p class="text-muted mb-0 ml-2 p-2">
                                                        More information about the PMode can be found <b><a href="http://tipsforbbq.com/Definition/Traeger-P-Setting" target="blank">here.</a></b> 
                                                    </p>
                                                    
                                            </div>
                                            <!-- Help Modal -->
                                            <div class="modal fade" id="helpModal" tabindex="-1" role="dialog" aria-labelledby="helpModalLabel" aria-hidden="true">
                                                <div class="modal-dialog modal-dialog-centered" role="document">
                                                    <div class="modal-content">
                                                        <div class="modal-header border rounded bg-primary border-primary">
                                                            <h5 class="modal-title" id="helpModalLabel">P-Mode Help</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="list-group-item">
                                                                <table class="table table-bordered">
                                                                    <thead class="thead-light">
                                                                        <tr>
                                                                            <th>P-Mode</th>
                                                                            <th>Auger ON Time</th>
                                                                            <th>Auger OFF Time</th>
                                                                            <th>Total Cycle Time</th>
                                                                        </tr>
                                                                    </thead>
                                                                    {% for row in range(10) %}
                                                                    <tbody>
                                                                        {% if row == settings['cycle_data']['PMode'] %}
                                                                        <tr class="table-warning">
                                                                            {% else %}
                                                                        <tr>
                                                                            {% endif %}
                                                                            <td>{{ row }} {% if (row == 2) %}(Factory Default){% endif %}</td>
                                                                            <td>{{ settings['cycle_data']['SmokeOnCycleTime'] }}s</td>
                                                                            <td>{{ (row * 10) + settings['cycle_data']['SmokeOffCycleTime'] }}s</td>
                                                                            <td>{{ settings['cycle_data']['SmokeOnCycleTime'] + (row * 10) + settings['cycle_data']['SmokeOffCycleTime'] }}s</td>
                                                                        </tr>
                                                                        {% endfor %}
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div><!-- End of card body -->
                                    </div><!-- End of Collapse -->
                                </div><!-- End of Card -->
                                <!-- Smoke Plus Settings -->
                                <div class="card shadow-sm mt-2">
                                    <div class="btn bg-secondary section-header justify-content-between align-items-center flex-column flex-sm-row" data-toggle="collapse" data-target="#collapseSmokePlus" aria-expanded="false" aria-controls="collapseSmokePlus" style="cursor: pointer;">
                                        <h5 class="mb-0 d-flex justify-content-between align-items-center w-100 w-sm-auto">
                                            <div class="d-flex align-items-start">
                                                <i class="fas fa-smog mr-2"></i>Smoke Plus Settings
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-chevron-down ml-2 mr-2"></i>
                                                <div>
                                                    {% if settings['smoke_plus']['enabled'] %}
                                                        <div>
                                                            <span class="badge badge-success">ON</span>
                                                        </div>
                                                    {% else %}
                                                        <div>
                                                            <span class="badge badge-danger">OFF</span>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </h5>
                                    </div>
                                    <div class="collapse" id="collapseSmokePlus">
                                        <div class="card-body">
                                            <!-- Smoke Plus Settings Body -->
                                            <div class="list-group">
                                                <div class="list-group-item border rounded border-success">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-smog mr-2"></i>Smoke Plus as Default</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="default_smoke_plus" name="default_smoke_plus" {% if settings['smoke_plus']['enabled'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="default_smoke_plus"></label>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <b>Defaults Smoke Mode to Smoke Plus Mode.</b>
                                                        </p>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                            Smoke Plus Mode can be toggled on/off by tapping the fan icon button on the dashboard. The icon will be highlighted blue indicating that smoke plus is enabled. Smoke Plus will cycle the fan on and off during smoke and hold mode to promote additional smoke generation. Fan cycling will only occur between the below min/max temperatures.
                                                        </p>
                                                    </div>
                                                </div>
                                                <!-- Fan Ramping -->
                                                {% if settings['globals']['dc_fan'] %}
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-sync-alt mr-2"></i>Fan Ramping</strong>
                                                        </div>
                                                        <div class="custom-control custom-switch d-flex justify-content-end">
                                                            <input type="checkbox" class="custom-control-input" id="sp_fan_ramp" name="sp_fan_ramp" {% if settings['smoke_plus']['fan_ramp'] %}checked{% endif %}>
                                                            <label class="custom-control-label" for="sp_fan_ramp"></label>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <span class="badge badge-primary badge-note mr-2">NOTE</span>
                                                            Fan Ramping will ramp the fan from off to the desired duty cycle instead of just turning on to full speed during Smoke Plus cycling. You can control the ramp duration by setting the Fan ON Time below. The desired duty cycle can also be set below.
                                                        </p>
                                                    </div>
                                                    <div id="sp_fan_ramp_input" class="list-group-item rounded mt-2 mb-3 p-1 bg-light" style="display: {% if settings['smoke_plus']['fan_ramp'] == 0 %}none{% else %}block{% endif %};">
                                                        <div class="d-flex align-items-center justify-content-between">
                                                            <strong><i class="far fa-clock mr-2"></i>Ramp Duty Cycle (%)</strong>
                                                            <div class="col-3 col-lg-2 ml-auto mr-0 pr-0">
                                                                <input id="sp_duty_cycle" type="number" inputmode="numeric" min="20" max="100" class="form-control" placeholder="{{ settings['smoke_plus']['duty_cycle'] }}" value="{{ settings['smoke_plus']['duty_cycle'] }}" name="sp_duty_cycle">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% endif %}
                                                <!-- Fan ON Time -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="far fa-clock mr-2"></i>Fan ON Time</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="sp_on_time" type="number" inputmode="numeric" min="sp_fade_in.value" class="form-control" placeholder="{{ settings['smoke_plus']['on_time'] }}" value="{{ settings['smoke_plus']['on_time'] }}" name="sp_on_time" style="min-width: 5ch;">
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <b>Default:</b> 5
                                                        </p> 
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            Number of seconds the fan will remain ON during fan cycling (seconds).
                                                        </p>
                                                    </div>
                                                </div>
                                                <!-- Fan OFF Time -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="far fa-clock mr-2"></i>Fan OFF Time</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="sp_off_time" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['smoke_plus']['off_time'] }}" value="{{ settings['smoke_plus']['off_time'] }}" name="sp_off_time" style="min-width: 5ch;">
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <b>Default:</b> 5
                                                        </p> 
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            Number of seconds the fan will remain OFF during fan cycling (seconds).
                                                        </p>
                                                    </div>
                                                </div>
                                                <!-- Min Operational Temp -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-temperature-high mr-2"></i>Min Operational Temp</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="sp_min_temp" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['smoke_plus']['min_temp'] }}" value="{{ settings['smoke_plus']['min_temp'] }}" name="sp_min_temp" style="min-width: 5ch;">
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <b>Default:</b> {% if settings['globals']['units'] == 'F' %}
                                                                                160 &deg;F
                                                                            {% else %}
                                                                                71 &deg;C
                                                                            {% endif %}
                                                        </p> 
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            Lowest temperature for Smoke Plus to operate. ({{settings['globals']['units']}})
                                                        </p>
                                                    </div>
                                                </div>
                                                <!-- Max Operational Temp -->
                                                <div class="list-group-item">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <strong><i class="fas fa-temperature-high mr-2"></i>Max Operational Temp</strong>
                                                        </div>
                                                        <div class="col-3 col-lg-2 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                            <input id="sp_max_temp" type="number" inputmode="numeric" min="1" class="form-control" placeholder="{{ settings['smoke_plus']['max_temp'] }}" value="{{ settings['smoke_plus']['max_temp'] }}" name="sp_max_temp" style="min-width: 5ch;">
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            <b>Default:</b> {% if settings['globals']['units'] == 'F' %}
                                                                                220 &deg;F
                                                                            {% else %}
                                                                                104 &deg;C
                                                                            {% endif %}
                                                        </p> 
                                                        <p class="text-muted mb-0 ml-2 p-2">
                                                            Highest temperature for Smoke Plus to operate. ({{settings['globals']['units']}})
                                                        </p>
                                                    </div>
                                                </div>
                                            </div><!-- End of list group -->
                                        </div><!-- End of card body -->
                                    </div><!-- End of Collapse -->
                                </div><!-- End of Card -->
                                <!-- Controller Configuration -->
                                <div class="card shadow-sm mt-2 mb-2">
                                    <div class="btn bg-secondary section-header justify-content-between align-items-center" data-toggle="collapse" data-target="#collapseControllerConfig" aria-expanded="false" aria-controls="collapseControllerConfig" style="cursor: pointer;">
                                        <h5 class="mb-0 d-flex justify-content-between align-items-center">
                                            <div class="d-flex align-items-start">
                                                <i class="fas fa-microchip mr-2"></i>Controller Configuration (HOLD Mode)
                                            </div>
                                        </h5>
                                    </div>
                                    <div class="list-group">
                                        <div class="list-group-item border rounded border-success">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <strong><i class="fas fa-cog mr-2"></i>Selected Controller Type:</strong>
                                                </div>
                                                <div class="col-4 col-lg-3 ml-auto mr-0 pr-0 d-flex justify-content-end">
                                                    <select class="form-control" id="selectController" name="selectController">
                                                        {% for controller in controller_metadata %}
                                                            <option value="{{ controller }}" {% if settings['controller']['selected'] == controller %}selected{% endif %}>{{ controller_metadata[controller]['friendly_name'] }}</option>
                                                        {% endfor %}    
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="controller_config">
                                            {{ render_controller_config(settings['controller']['selected'], controller_metadata, settings['controller'], settings['cycle_data']) }}
                                        </div>
                                    </div><!-- End of List Group -->
                                </div><!-- End of Card -->
                                <div class="card-footer bg-secondary rounded mb-1 mt-2 py-1">
                                    <div class="row">
                                        <div class="col-12">
                                            <button type="submit" class="btn btn-danger mr-1">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div><!-- End of Card -->
                    </div><!-- End of Work Mode Tab -->
                </div><!-- End of Pills Tab Content -->
            </div>
        </div>
    </div>
{% endblock %}           
            
{% block postcontainer %}
{% endblock %}

{% block scripts %}
<script>
    var dc_fan_enabled = "{{ settings['globals']['dc_fan'] }}";
    var currentPage = 'settings';

    function toggleHoldTemp() {
        var mode = document.getElementById('after_startup_mode').value;
        if (mode === 'Hold') {
            $('#holdTemp').slideDown();
        } else {
            $('#holdTemp').slideUp();
        }
    }

    $(document).ready(function() {
        toggleHoldTemp();  // Call the function on page load

        $('.nav-link').on('click', function(){
            $('.navbar-collapse').collapse('hide');
        });

        var hash = window.location.hash;
        $('.nav-link[href="' + hash + '"]').tab('show');

        $(".alert-success").delay(1500).slideUp(200, function() {
            $(this).alert('close');
        });

        $('.collapse').on('show.bs.collapse', function (e) {
            var targetId = $(this).attr('id');
            var selector = '[data-target="#' + targetId + '"] .fa-chevron-down';
            $(selector).removeClass('fa-chevron-down').addClass('fa-chevron-up');

            if (targetId.startsWith('edit_device')) {
                e.stopPropagation();
            }
        });

        $('.collapse').on('hide.bs.collapse', function (e) {
            var targetId = $(this).attr('id');
            var selector = '[data-target="#' + targetId + '"] .fa-chevron-up';
            $(selector).removeClass('fa-chevron-up').addClass('fa-chevron-down');

            if (targetId.startsWith('edit_device')) {
                e.stopPropagation();
            }
        });

        let pageTheme = "{% if settings['globals']['page_theme'] == 'dark' %}dark{% else %}{% endif %}";
        let sectionHeaders = document.querySelectorAll('.section-header');

        sectionHeaders.forEach(header => {
            if (pageTheme === 'dark') {
                header.classList.remove('bg-dark', 'text-white');
                header.classList.add('bg-secondary');
            } else {
                header.classList.remove('bg-secondary');
                header.classList.add('bg-dark', 'text-white');
            }
        }); 
    });
</script>
<script src="{{ url_for('static', filename='js/bootstrap-colorpicker.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/settings.js') }}"></script>

{% endblock %}
